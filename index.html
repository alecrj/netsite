<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>ResellAI - Put Your Business on Autopilot</title>
  
  <style>
    @import url('https://fonts.cdnfonts.com/css/ms-sans-serif');
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'MS Sans Serif', sans-serif;
      font-size: 11px;
      background: linear-gradient(45deg, #008080 0%, #004040 100%);
      height: 100vh;
      overflow: hidden;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: default;
      position: relative;
    }

    /* Theme backgrounds - Only working ones */
    body.theme-teal { 
      background: linear-gradient(45deg, #008080 0%, #004040 100%);
    }
    
    body.theme-sunset { 
      background: linear-gradient(45deg, #ff6b9d 0%, #c44569 25%, #f8b500 50%, #40407a 75%, #706fd3 100%);
      background-size: 400% 400%;
      animation: retro-gradient 8s ease infinite;
    }
    
    body.theme-matrix { 
      background: #000;
      background-image: 
        repeating-linear-gradient(0deg, transparent, transparent 20px, #0f4 21px, #0f4 22px),
        repeating-linear-gradient(90deg, transparent, transparent 20px, #0f4 21px, #0f4 22px);
      background-size: 21px 21px;
    }

    @keyframes retro-gradient { 
      0% { background-position: 0% 50%; } 
      50% { background-position: 100% 50%; } 
      100% { background-position: 0% 50%; } 
    }

    /* Desktop Layout - Mobile First */
    .desktop {
      position: relative;
      height: calc(100vh - 50px);
      padding: 15px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .desktop-icons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      max-width: 100%;
      justify-items: center;
      align-content: start;
      min-height: 100%;
    }

    @media (min-width: 768px) {
      .desktop {
        padding: 40px;
        overflow: visible;
      }
      
      .desktop-icons {
        display: block;
        position: relative;
        height: 100%;
      }
    }

    /* Desktop Icons - Perfect Mobile Sizing */
    .desktop-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 15px;
      cursor: pointer;
      user-select: none;
      width: 150px;
      min-height: 130px;
      background: rgba(255, 255, 255, 0.12);
      border-radius: 15px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    @media (min-width: 768px) {
      .desktop-icon {
        position: absolute;
        width: 100px;
        min-height: 90px;
        background: transparent;
        border: none;
        backdrop-filter: none;
        border-radius: 0;
        box-shadow: none;
        padding: 15px 10px;
      }
    }

    .desktop-icon:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-5px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
    }

    @media (min-width: 768px) {
      .desktop-icon:hover {
        background: rgba(255, 255, 255, 0.15);
        border-radius: 10px;
        transform: translateY(-3px);
      }
    }

    .desktop-icon:active {
      transform: scale(0.95);
    }

    .desktop-icon.selected {
      background: rgba(0, 0, 139, 0.4);
      border: 3px dotted white;
    }

    /* Authentic Windows 98 Folder Icons */
    .folder-icon {
      position: relative;
      width: 70px;
      height: 55px;
      margin-bottom: 15px;
    }

    @media (min-width: 768px) {
      .folder-icon {
        width: 50px;
        height: 40px;
        margin-bottom: 10px;
      }
    }

    .folder-body {
      position: absolute;
      width: 100%;
      height: 75%;
      bottom: 0;
      left: 0;
      background: linear-gradient(135deg, #FFFF80 0%, #FFFF60 30%, #FFFF40 70%, #FFFF20 100%);
      border: 2px solid;
      border-color: #FFFFFF #999999 #999999 #FFFFFF;
      box-shadow: 
        inset 2px 2px 0 #FFFFFF, 
        inset -2px -2px 0 #999999,
        4px 4px 10px rgba(0,0,0,0.5);
      border-radius: 3px;
    }

    .folder-tab {
      position: absolute;
      width: 35%;
      height: 32%;
      top: 0;
      left: 4px;
      background: linear-gradient(135deg, #FFFF80 0%, #FFFF60 30%, #FFFF40 70%, #FFFF20 100%);
      border: 2px solid;
      border-color: #FFFFFF #999999 transparent #FFFFFF;
      border-bottom: none;
      box-shadow: inset 2px 2px 0 #FFFFFF, inset -2px 0 0 #999999;
      border-radius: 3px 3px 0 0;
    }

    /* Special folder variants */
    .folder-icon.download .folder-body, .folder-icon.download .folder-tab {
      background: linear-gradient(135deg, #80FF80 0%, #60FF60 30%, #40DD40 70%, #20BB20 100%);
      animation: pulse-download 3s ease-in-out infinite;
    }

    @keyframes pulse-download {
      0%, 100% { 
        box-shadow: 
          inset 2px 2px 0 #FFFFFF, 
          inset -2px -2px 0 #999999,
          4px 4px 10px rgba(0,0,0,0.5),
          0 0 25px rgba(64,255,64,0.4);
      }
      50% { 
        box-shadow: 
          inset 2px 2px 0 #FFFFFF, 
          inset -2px -2px 0 #999999,
          4px 4px 15px rgba(0,0,0,0.7),
          0 0 40px rgba(64,255,64,0.7);
        transform: scale(1.08);
      }
    }

    .folder-icon.urgent .folder-body, .folder-icon.urgent .folder-tab {
      background: linear-gradient(135deg, #FF8080 0%, #FF6060 30%, #FF4040 70%, #FF2020 100%);
    }

    .folder-icon.system .folder-body, .folder-icon.system .folder-tab {
      background: linear-gradient(135deg, #FFE080 0%, #FFD060 30%, #FFC040 70%, #FFB020 100%);
    }

    /* App Icons */
    .app-icon {
      position: relative;
      width: 70px;
      height: 70px;
      margin-bottom: 15px;
      background: linear-gradient(135deg, #E0E0E0 0%, #C0C0C0 50%, #A0A0A0 100%);
      border: 3px solid;
      border-color: #FFFFFF #808080 #808080 #FFFFFF;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 35px;
      box-shadow: 
        inset 2px 2px 0 #F0F0F0, 
        inset -2px -2px 0 #808080,
        4px 4px 10px rgba(0,0,0,0.5);
      border-radius: 4px;
    }

    @media (min-width: 768px) {
      .app-icon {
        width: 50px;
        height: 50px;
        margin-bottom: 10px;
        font-size: 25px;
        border: 2px solid;
      }
    }

    /* Icon labels */
    .icon-label {
      color: white;
      font-size: 14px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.9);
      max-width: 130px;
      word-wrap: break-word;
      line-height: 1.3;
      font-weight: bold;
    }

    @media (min-width: 768px) {
      .icon-label {
        font-size: 11px;
        max-width: 80px;
      }
    }

    .icon-label.selected {
      background: #000080;
      color: white;
      padding: 4px 8px;
      border-radius: 3px;
    }

    /* Windows - Perfect Mobile Fit */
    .window {
      position: fixed;
      background: #C0C0C0;
      border: 3px outset #C0C0C0;
      box-shadow: 8px 8px 20px rgba(0,0,0,0.6);
      min-width: 300px;
      min-height: 200px;
      display: none;
      z-index: 100;
      border-radius: 0;
    }

    .window.active {
      display: block;
    }

    .window.focused {
      z-index: 1000;
    }

    /* Mobile window sizing - Perfect fit */
    @media (max-width: 767px) {
      .window {
        width: 96vw !important;
        height: calc(92vh - 50px) !important;
        top: 4vh !important;
        left: 2vw !important;
        max-height: calc(92vh - 50px);
      }
    }

    .window-titlebar {
      height: 30px;
      background: linear-gradient(90deg, #0A246A 0%, #A6CAF0 3%, #1A56B8 6%, #1A56B8 94%, #A6CAF0 97%, #0A246A 100%);
      border-bottom: 1px solid #808080;
      display: flex;
      align-items: center;
      padding: 4px 10px;
      cursor: move;
      user-select: none;
    }

    .window.unfocused .window-titlebar {
      background: linear-gradient(90deg, #808080 0%, #C0C0C0 3%, #A0A0A0 6%, #A0A0A0 94%, #C0C0C0 97%, #808080 100%);
    }

    .window-icon {
      width: 20px;
      height: 20px;
      margin-right: 10px;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .window-title {
      color: white;
      font-size: 12px;
      font-weight: bold;
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .window.unfocused .window-title {
      color: #808080;
    }

    .window-controls {
      display: flex;
      gap: 4px;
    }

    .window-control-btn {
      width: 22px;
      height: 20px;
      background: #C0C0C0;
      border: 1px outset #C0C0C0;
      font-size: 11px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: black;
    }

    .window-control-btn:hover {
      background: #DFDFDF;
    }

    .window-control-btn:active {
      border: 1px inset #C0C0C0;
      background: #A0A0A0;
    }

    .window-content {
      padding: 20px;
      background: #C0C0C0;
      height: calc(100% - 30px);
      overflow-y: auto;
      border-top: 1px solid #DFDFDF;
      -webkit-overflow-scrolling: touch;
    }

    /* Alerts and notifications */
    .critical-alert {
      background: #FFCCCC;
      border: 3px solid #FF0000;
      padding: 15px;
      margin: 15px 0;
      font-weight: bold;
      animation: blink-red 2s ease-in-out infinite;
      border-radius: 4px;
      font-size: 12px;
    }

    @keyframes blink-red {
      0%, 50% { background: #FFCCCC; }
      51%, 100% { background: #FFE0E0; }
    }

    .warning-alert {
      background: #FFFFCC;
      border: 3px solid #FFAA00;
      padding: 15px;
      margin: 15px 0;
      font-weight: bold;
      border-radius: 4px;
      font-size: 12px;
    }

    .success-alert {
      background: #CCFFCC;
      border: 3px solid #00AA00;
      padding: 15px;
      margin: 15px 0;
      font-weight: bold;
      border-radius: 4px;
      font-size: 12px;
    }

    /* Progress bars */
    .progress-container {
      background: #808080;
      border: 2px inset #C0C0C0;
      height: 30px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress-bar {
      height: 26px;
      background: linear-gradient(90deg, #0000FF 0%, #0000CC 50%, #000088 100%);
      transition: width 0.8s ease;
      position: relative;
    }

    .progress-bar.success {
      background: linear-gradient(90deg, #00AA00 0%, #008800 50%, #006600 100%);
    }

    .progress-bar.danger {
      background: linear-gradient(90deg, #FF0000 0%, #CC0000 50%, #880000 100%);
    }

    /* Buttons */
    .btn-98 {
      background: #C0C0C0;
      border: 3px outset #C0C0C0;
      padding: 10px 20px;
      font-family: 'MS Sans Serif', sans-serif;
      font-size: 12px;
      cursor: pointer;
      margin: 8px;
      min-height: 36px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 2px;
    }

    .btn-98:hover {
      background: #DFDFDF;
    }

    .btn-98:active {
      border: 3px inset #C0C0C0;
      background: #A0A0A0;
    }

    .download-btn {
      background: linear-gradient(180deg, #00FF00 0%, #00CC00 100%);
      border: 3px outset #00CC00;
      color: black;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 12px;
      padding: 15px 25px;
      font-weight: bold;
      font-size: 16px;
      box-shadow: 4px 4px 10px rgba(0,0,0,0.4);
      font-family: 'MS Sans Serif', sans-serif;
      cursor: pointer;
      animation: download-pulse 3s ease-in-out infinite;
      min-height: 45px;
      border-radius: 3px;
    }

    @keyframes download-pulse {
      0%, 100% { 
        transform: scale(1);
        box-shadow: 4px 4px 10px rgba(0,0,0,0.4);
      }
      50% { 
        transform: scale(1.05);
        box-shadow: 8px 8px 20px rgba(0,0,0,0.6), 0 0 30px rgba(0,255,0,0.5);
      }
    }

    .download-btn:hover {
      background: linear-gradient(180deg, #33FF33 0%, #00DD00 100%);
    }

    .download-btn:active {
      border: 3px inset #00CC00;
      background: linear-gradient(180deg, #00CC00 0%, #009900 100%);
    }

    /* Content layouts */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .stat-card {
      background: #F0F0F0;
      border: 3px inset #C0C0C0;
      padding: 15px;
      text-align: center;
      border-radius: 3px;
    }

    .stat-number {
      font-size: 26px;
      font-weight: bold;
      color: #000080;
    }

    .stat-label {
      font-size: 11px;
      color: #000080;
      margin-top: 5px;
    }

    .highlight-box {
      background: #FFFFCC;
      border: 3px inset #C0C0C0;
      padding: 18px;
      margin: 18px 0;
      border-radius: 3px;
    }

    .highlight-box h4 {
      color: #000080;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .highlight-box p {
      font-size: 12px;
      line-height: 1.5;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .feature-card {
      background: #F0F0F0;
      border: 3px inset #C0C0C0;
      padding: 15px;
      text-align: center;
      border-radius: 3px;
    }

    .feature-card h4 {
      color: #000080;
      margin-bottom: 10px;
      font-size: 13px;
    }

    .feature-card p {
      font-size: 12px;
      line-height: 1.4;
    }

    /* Terminal */
    .terminal {
      background: #000000;
      color: #00FF00;
      font-family: 'Courier New', monospace;
      padding: 15px;
      border: 3px inset #C0C0C0;
      margin: 15px 0;
      font-size: 12px;
      height: 150px;
      overflow-y: auto;
      border-radius: 3px;
    }

    .terminal-cursor {
      animation: cursor-blink 1s infinite;
    }

    @keyframes cursor-blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Taskbar */
    .taskbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 50px;
      background: #C0C0C0;
      border-top: 2px solid #DFDFDF;
      display: flex;
      align-items: center;
      padding: 5px;
      z-index: 2000;
      box-shadow: inset 0 2px 0 #FFFFFF;
    }

    .start-button {
      background: #C0C0C0;
      border: 3px outset #C0C0C0;
      padding: 10px 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-weight: bold;
      font-size: 13px;
      box-shadow: inset 2px 2px 0 #DFDFDF;
      border-radius: 3px;
    }

    .start-button:active, .start-button.pressed {
      border: 3px inset #C0C0C0;
      box-shadow: inset -2px -2px 0 #DFDFDF;
    }

    .taskbar-separator {
      width: 4px;
      height: 38px;
      background: #808080;
      border-right: 1px solid #DFDFDF;
      margin: 0 10px;
    }

    .taskbar-buttons {
      display: flex;
      gap: 4px;
      flex: 1;
      overflow: hidden;
    }

    .taskbar-button {
      background: #C0C0C0;
      border: 2px outset #C0C0C0;
      padding: 8px 15px;
      cursor: pointer;
      font-size: 11px;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 8px;
      border-radius: 2px;
    }

    .taskbar-button.active {
      border: 2px inset #C0C0C0;
      background: #A0A0A0;
    }

    .taskbar-button:hover:not(.active) {
      background: #DFDFDF;
    }

    .system-tray {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-left: auto;
      padding: 0 10px;
      border: 2px inset #C0C0C0;
      background: #C0C0C0;
      height: 32px;
      border-radius: 2px;
    }

    .system-tray-item {
      font-size: 14px;
      cursor: pointer;
      padding: 4px 6px;
    }

    .clock {
      font-size: 12px;
      padding: 8px 12px;
      border: 2px inset #C0C0C0;
      background: #C0C0C0;
      border-radius: 2px;
    }

    /* Start Menu */
    .start-menu {
      position: fixed;
      bottom: 50px;
      left: 5px;
      width: 260px;
      background: #C0C0C0;
      border: 3px outset #C0C0C0;
      box-shadow: 10px 10px 25px rgba(0,0,0,0.6);
      z-index: 3000;
      display: none;
      border-radius: 2px;
    }

    .start-menu.show {
      display: block;
      animation: startMenuSlide 0.3s ease-out;
    }

    @keyframes startMenuSlide {
      from { opacity: 0; transform: translateY(25px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .start-menu-banner {
      background: linear-gradient(90deg, #000080 0%, #000040 100%);
      color: white;
      padding: 15px;
      font-weight: bold;
      font-size: 24px;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      width: 35px;
      height: 260px;
      float: left;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .start-menu-items {
      margin-left: 35px;
      padding: 10px 0;
    }

    .start-menu-item {
      padding: 12px 20px 12px 45px;
      cursor: pointer;
      display: flex;
      align-items: center;
      font-size: 13px;
      position: relative;
      border-bottom: 1px solid #E0E0E0;
    }

    .start-menu-item::before {
      content: attr(data-icon);
      position: absolute;
      left: 15px;
      font-size: 20px;
      width: 20px;
      text-align: center;
    }

    .start-menu-item:hover {
      background: #0000AA;
      color: white;
    }

    .start-menu-item.separator {
      height: 2px;
      background: #808080;
      margin: 8px 15px;
      padding: 0;
      border: none;
    }

    /* Popups */
    .popup {
      position: fixed;
      background: #C0C0C0;
      border: 3px outset #C0C0C0;
      box-shadow: 10px 10px 25px rgba(0,0,0,0.7);
      z-index: 5000;
      display: none;
      min-width: 360px;
      max-width: 450px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 2px;
    }

    .popup.show {
      display: block;
      animation: popupAppear 0.4s ease-out;
    }

    @keyframes popupAppear {
      from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
      to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .popup-titlebar {
      height: 28px;
      background: linear-gradient(90deg, #FF6600 0%, #CC4400 100%);
      border-bottom: 1px solid #808080;
      display: flex;
      align-items: center;
      padding: 4px 10px;
      cursor: move;
    }

    .popup-titlebar.alert {
      background: linear-gradient(90deg, #FF0000 0%, #CC0000 100%);
    }

    .popup-icon {
      width: 20px;
      height: 20px;
      margin-right: 10px;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .popup-title {
      color: white;
      font-size: 13px;
      font-weight: bold;
      flex: 1;
    }

    .popup-content {
      padding: 25px;
      text-align: center;
    }

    .popup-content h3 {
      color: #000080;
      margin-bottom: 20px;
      font-size: 16px;
    }

    .popup-content p {
      font-size: 13px;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .popup-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 25px;
      flex-wrap: wrap;
    }

    /* Hidden audio */
    .audio-hidden {
      position: absolute;
      left: -9999px;
      width: 1px;
      height: 1px;
      opacity: 0;
    }
  </style>
</head>
<body id="body" class="theme-teal">
  
  <!-- Hidden Audio Elements -->
  <audio id="clickSound" class="audio-hidden" preload="auto">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2xm0jAyu6yO3eoyEAB2m29N6RQwsbWLDr7qZSAgA+n+b5zm8lAWqw2OvgpyEAV7Lr5aVYAgA7k9/3x2whASeq1O/hmyEAZ7nh8N1+KgAH" type="audio/wav">
  </audio>
  <audio id="openSound" class="audio-hidden" preload="auto">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2xm0jAyu6yO3eoyEAB2m29N6RQwsbWLDr7qZSEgE+nx95zm8lAWqw2OvgpyUAV7Lr5aVYEgI7k9/3x2whASeq1O/hmyEAZ7nh8N1+KgEH" type="audio/wav">
  </audio>
  <audio id="errorSound" class="audio-hidden" preload="auto">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+D2xm0jAyu6yO3eoyEAB2m29N6RQwsbWLDr7qZSEgE+nx95zm8lAWqw2OvgpyUAV7Lr5aVYEgI7k9/3x2whASeq1O/hmyEAZ7nh8N1+KgEH" type="audio/wav">
  </audio>

  <!-- Desktop -->
  <div class="desktop" id="desktop">
    <div class="desktop-icons">
      
      <!-- What is ResellAI -->
      <div class="desktop-icon" style="top: 40px; left: 40px;" onclick="openWindow('what-is-window')">
        <div class="folder-icon">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">What is ResellAI</div>
      </div>

      <!-- Why You Need This -->
      <div class="desktop-icon" style="top: 40px; left: 200px;" onclick="openWindow('why-need-window')">
        <div class="folder-icon urgent">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Why You Need This</div>
      </div>

      <!-- How It Works -->
      <div class="desktop-icon" style="top: 180px; left: 40px;" onclick="openWindow('how-works-window')">
        <div class="folder-icon">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">How It Works</div>
      </div>

      <!-- Download ResellAI -->
      <div class="desktop-icon" style="top: 180px; left: 200px;" onclick="openWindow('download-window')">
        <div class="folder-icon download">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Download ResellAI</div>
      </div>

      <!-- Pricing & ROI -->
      <div class="desktop-icon" style="top: 320px; left: 40px;" onclick="openWindow('pricing-window')">
        <div class="folder-icon system">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Pricing & ROI</div>
      </div>

      <!-- System Check -->
      <div class="desktop-icon" style="top: 320px; left: 200px;" onclick="openWindow('system-check-window')">
        <div class="app-icon">🔍</div>
        <div class="icon-label">System Check</div>
      </div>

      <!-- Themes -->
      <div class="desktop-icon" style="top: 40px; right: 40px;" onclick="openWindow('themes-window')">
        <div class="app-icon">🎨</div>
        <div class="icon-label">Themes</div>
      </div>

    </div>
  </div>

  <!-- Windows -->

  <!-- What is ResellAI Window -->
  <div class="window" id="what-is-window" style="top: 80px; left: 150px; width: 550px; height: 500px;">
    <div class="window-titlebar">
      <div class="window-icon">💎</div>
      <div class="window-title">What is ResellAI - Your Business on Complete Autopilot</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('what-is-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('what-is-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('what-is-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <h2 style="color: #000080; margin-bottom: 20px; font-size: 18px;">🚀 Put Your Entire Resell Business on Autopilot</h2>
      
      <div class="success-alert">
        ✅ The ONLY app that does EVERYTHING after you source items
      </div>
      
      <p style="margin-bottom: 20px; font-size: 14px; line-height: 1.5;"><strong>Stop doing busywork. Start scaling your business:</strong></p>
      
      <div style="background: #F0F0F0; border: 3px inset #C0C0C0; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 32px; margin-bottom: 15px;">📱 → 🤖 → 💰</div>
        <p style="font-weight: bold; color: #000080; font-size: 16px;">Source Items → Take Photo → AI Handles Everything → Get Paid</p>
      </div>
      
      <div class="highlight-box">
        <h4>What ResellAI Does For You (100% Automated):</h4>
        <p><strong>✅ AI Identifies Everything</strong> (brand, model, condition, defects, value)<br>
        <strong>✅ Writes Perfect Descriptions</strong> (SEO-optimized, compelling copy)<br>
        <strong>✅ Sets Optimal Prices</strong> (real-time market analysis)<br>
        <strong>✅ Posts to All Platforms</strong> (eBay, Mercari, Facebook, Poshmark)<br>
        <strong>✅ Manages Your Listings</strong> (price drops, relisting, promotions)</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number">30sec</div>
          <div class="stat-label">Total Time Required</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">0min</div>
          <div class="stat-label">Writing Time</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">0min</div>
          <div class="stat-label">Research Time</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">0min</div>
          <div class="stat-label">Posting Time</div>
        </div>
      </div>

      <div style="text-align: center; margin-top: 25px;">
        <a href="#" class="download-btn" onclick="openWindow('download-window')">
          💾 GET RESELLAI FREE
        </a>
        <button class="btn-98" onclick="openWindow('how-works-window')">How It Works</button>
      </div>
    </div>
  </div>

  <!-- Why You Need This Window -->
  <div class="window" id="why-need-window" style="top: 120px; left: 200px; width: 520px; height: 520px;">
    <div class="window-titlebar">
      <div class="window-icon">⚠️</div>
      <div class="window-title">Why You NEED This - Stop Wasting Your Life</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('why-need-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('why-need-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('why-need-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <div class="critical-alert">
        🚨 BRUTAL REALITY: You're working 30x harder than you need to
      </div>
      
      <h3 style="color: #FF0000; margin-bottom: 20px;">The Manual Listing Nightmare:</h3>
      
      <div style="background: #FFEEEE; border: 3px solid #FF0000; padding: 18px; margin: 15px 0;">
        <p style="font-weight: bold; margin-bottom: 12px;">What you do now (PER ITEM):</p>
        <p style="font-size: 13px; line-height: 1.6;">
          ⏰ 8 minutes taking/editing photos<br>
          ⏰ 5 minutes researching comparable prices<br>
          ⏰ 12 minutes writing descriptions<br>
          ⏰ 3 minutes posting to each platform<br>
          <span style="color: #FF0000; font-weight: bold; font-size: 18px;">= 15+ MINUTES PER ITEM!</span>
        </p>
      </div>

      <div class="warning-alert">
        💡 REALITY CHECK: At 20 items/week, you're spending 5+ HOURS on busywork alone
      </div>

      <div class="feature-grid" style="grid-template-columns: 1fr 1fr;">
        <div style="background: #FFEEEE; border: 3px solid #FF0000; padding: 15px;">
          <h4 style="color: #FF0000;">❌ Manual Way</h4>
          <p style="font-size: 12px;">
            • 15+ min per listing<br>
            • Guess at prices<br>
            • Boring descriptions<br>
            • Can't scale<br>
            • Burnout inevitable
          </p>
        </div>
        <div style="background: #EEFFEE; border: 3px solid #00AA00; padding: 15px;">
          <h4 style="color: #00AA00;">✅ ResellAI Way</h4>
          <p style="font-size: 12px;">
            • 30 sec per listing<br>
            • AI sets perfect prices<br>
            • Compelling copy<br>
            • Scale infinitely<br>
            • Pure profit focus
          </p>
        </div>
      </div>

      <div class="terminal">
CALCULATING YOUR WASTED TIME...<br>
Manual: 15 min/item × 100 items = 25 hours<br>
ResellAI: 0.5 min/item × 100 items = 0.8 hours<br>
TIME SAVED: 24.2 HOURS<br>
LIFE RECLAIMED: 3+ FULL WORK DAYS<br>
HOURLY VALUE: $500+ in saved labor<br>
<span class="terminal-cursor">█</span>
      </div>

      <div class="critical-alert">
        ⏱️ Every day you wait = 2+ hours of your life you'll never get back
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <a href="#" class="download-btn" onclick="openWindow('download-window')">
          ⚡ SAVE MY TIME NOW
        </a>
        <button class="btn-98" onclick="openWindow('pricing-window')">See ROI</button>
      </div>
    </div>
  </div>

  <!-- How It Works Window -->
  <div class="window" id="how-works-window" style="top: 160px; left: 250px; width: 500px; height: 450px;">
    <div class="window-titlebar">
      <div class="window-icon">📋</div>
      <div class="window-title">How ResellAI Works - Dead Simple Process</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('how-works-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('how-works-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('how-works-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <h3 style="color: #000080; margin-bottom: 20px;">📱 The 30-Second Process:</h3>
      
      <div class="feature-grid" style="grid-template-columns: 1fr; gap: 20px;">
        <div style="background: #E6F3FF; border: 3px inset #C0C0C0; padding: 18px; display: flex; align-items: center; gap: 18px;">
          <div style="font-size: 40px;">📸</div>
          <div>
            <h4 style="color: #000080; margin-bottom: 8px;">STEP 1: Take One Photo (10 seconds)</h4>
            <p style="font-size: 13px;">Snap a pic of your item. Our computer vision AI instantly identifies brand, condition, defects, and current market value.</p>
          </div>
        </div>
        
        <div style="background: #FFF0E6; border: 3px inset #C0C0C0; padding: 18px; display: flex; align-items: center; gap: 18px;">
          <div style="font-size: 40px;">🤖</div>
          <div>
            <h4 style="color: #000080; margin-bottom: 8px;">STEP 2: AI Does Everything (15 seconds)</h4>
            <p style="font-size: 13px;">ResellAI writes descriptions, researches optimal pricing, and creates listings for multiple platforms. Zero input needed.</p>
          </div>
        </div>
        
        <div style="background: #E6FFE6; border: 3px inset #C0C0C0; padding: 18px; display: flex; align-items: center; gap: 18px;">
          <div style="font-size: 40px;">💰</div>
          <div>
            <h4 style="color: #000080; margin-bottom: 8px;">STEP 3: Review & Publish (5 seconds)</h4>
            <p style="font-size: 13px;">Quick review, then publish to eBay, Mercari, Facebook, Poshmark simultaneously. AI handles all tedious work.</p>
          </div>
        </div>
      </div>

      <div class="success-alert">
        ✨ TOTAL TIME: 30 seconds. TOTAL EFFORT: Take one photo, tap publish.
      </div>

      <div class="highlight-box">
        <h4>What Happens Behind the Scenes:</h4>
        <p style="font-size: 12px;">• Computer vision analyzes 200,000+ similar items<br>
        • AI writes descriptions that sell 3x faster than human copy<br>
        • Pricing engine finds perfect balance: quick sale + maximum profit<br>
        • Auto-posts to all platforms with optimized titles and keywords<br>
        • Manages price drops, promotions, and relisting automatically</p>
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <a href="#" class="download-btn" onclick="openWindow('download-window')">
          🚀 START AUTOPILOT MODE
        </a>
        <button class="btn-98" onclick="openWindow('pricing-window')">See Plans</button>
      </div>
    </div>
  </div>

  <!-- Download Window -->
  <div class="window" id="download-window" style="top: 100px; left: 350px; width: 480px; height: 420px;">
    <div class="window-titlebar">
      <div class="window-icon">💾</div>
      <div class="window-title">Download ResellAI - Installation Center</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('download-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('download-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('download-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <div style="text-align: center;">
        <div class="critical-alert">
          🔥 FREE TO START: Get 5 AI listings to experience the magic
        </div>
        
        <h3 style="margin-bottom: 20px; color: #000080;">📱 Get ResellAI on Your Phone</h3>
        
        <div class="terminal" style="text-align: left;">
Initializing ResellAI installation...<br>
Checking device compatibility... ✅<br>
Downloading autopilot_engine.pkg... ✅<br>
Installing ai_listing_system... ✅<br>
Configuring profit_maximizer... ✅<br>
<br>
Ready for installation!<br>
Your productivity is about to increase 30x...<br>
<span class="terminal-cursor">█</span>
        </div>
        
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin: 25px 0;">
          <a href="https://apps.apple.com" class="download-btn" target="_blank">
            🍎 Download for iPhone
          </a>
          <a href="https://play.google.com" class="download-btn" target="_blank">
            🤖 Download for Android
          </a>
        </div>
        
        <div class="success-alert">
          ✅ 100% FREE to start • No credit card • 5 free AI listings included
        </div>

        <div style="font-size: 12px; color: #666; margin-top: 18px; line-height: 1.5;">
          <p>⭐ 4.9/5 stars in app stores</p>
          <p>🏆 #1 Productivity App for Resellers</p>
          <p>🔒 Bank-level security & privacy</p>
          <p>📱 Works on iOS 13+ and Android 8+</p>
        </div>

        <div style="margin-top: 20px;">
          <button class="btn-98" onclick="openWindow('pricing-window')">See Pricing</button>
          <button class="btn-98" onclick="openWindow('system-check-window')">System Check</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pricing Window with Fixed Calculator -->
  <div class="window" id="pricing-window" style="top: 140px; left: 400px; width: 450px; height: 460px;">
    <div class="window-titlebar">
      <div class="window-icon">💰</div>
      <div class="window-title">Pricing & ROI Calculator</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('pricing-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('pricing-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('pricing-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <h3 style="color: #000080; margin-bottom: 20px;">💎 See Your Time & Money Savings</h3>
      
      <div style="border: 3px inset #C0C0C0; padding: 15px; margin-bottom: 20px;">
        <p style="font-size: 13px; margin-bottom: 10px; font-weight: bold;">Items you could list per month:</p>
        <input type="range" min="10" max="500" value="50" style="width: 100%; height: 25px;" oninput="calculateROI(this.value)">
        <p style="text-align: center; font-size: 16px; font-weight: bold; margin-top: 10px;" id="itemCount">50 items</p>
      </div>

      <div class="stats-grid" style="grid-template-columns: 1fr 1fr;">
        <div class="stat-card">
          <div class="stat-number" id="manualTime">12.5 hrs</div>
          <div class="stat-label">Manual Time Wasted</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="aiTime">25 min</div>
          <div class="stat-label">Time With ResellAI</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="timeSaved">12 hrs</div>
          <div class="stat-label">Time Reclaimed</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="moneySaved">$250</div>
          <div class="stat-label">Value of Time Saved</div>
        </div>
      </div>

      <div class="feature-grid" style="grid-template-columns: 1fr 1fr;">
        <div class="feature-card">
          <h4>🆓 Starter (FREE)</h4>
          <p><strong>$0/month</strong></p>
          <p style="font-size: 11px;">• 5 AI listings<br>• Test the magic<br>• All core features<br>• Perfect for trying</p>
        </div>
        <div class="feature-card" style="border: 3px solid #00AA00;">
          <h4>⭐ Pro ($19/month)</h4>
          <p><strong>Unlimited listings</strong></p>
          <p style="font-size: 11px;">• All platforms<br>• Priority processing<br>• Advanced analytics<br>• Business scaling</p>
        </div>
      </div>

      <div class="success-alert">
        💡 Pro plan pays for itself with time saved on just 4 listings
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <a href="#" class="download-btn" onclick="openWindow('download-window')">
          💎 START FREE NOW
        </a>
      </div>
    </div>
  </div>

  <!-- System Check Window -->
  <div class="window" id="system-check-window" style="top: 180px; left: 120px; width: 480px; height: 480px;">
    <div class="window-titlebar">
      <div class="window-icon">🔍</div>
      <div class="window-title">System Performance Check - Issues Detected</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('system-check-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('system-check-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('system-check-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <div class="critical-alert">
        🚨 CRITICAL: MANUAL_LISTING.exe detected - consuming 95% of your productivity!
      </div>
      
      <h3 style="color: #FF0000; margin-bottom: 20px;">⚠️ System Scan Results:</h3>
      
      <div class="terminal">
C:\> Scanning selling efficiency...<br>
<br>
THREAT DETECTED: manual_research.exe<br>
THREAT DETECTED: slow_typing.dll<br>
THREAT DETECTED: price_guessing.sys<br>
THREAT DETECTED: time_waster.bat<br>
THREAT DETECTED: burnout_generator.exe<br>
<br>
PRODUCTIVITY LOSS: 95%<br>
TIME WASTE: 12+ hours/week<br>
SYSTEM STATUS: SEVERELY COMPROMISED<br>
<br>
RECOMMENDED: Install ResellAI.exe<br>
<span class="terminal-cursor">█</span>
      </div>
      
      <div style="margin: 20px 0;">
        <p style="font-weight: bold; margin-bottom: 15px;">Current Performance Analysis:</p>
        
        <p style="font-size: 12px;">Listing Speed:</p>
        <div class="progress-container">
          <div class="progress-bar danger" style="width: 5%"></div>
        </div>
        
        <p style="font-size: 12px;">Price Accuracy:</p>
        <div class="progress-container">
          <div class="progress-bar danger" style="width: 8%"></div>
        </div>
        
        <p style="font-size: 12px;">Business Automation:</p>
        <div class="progress-container">
          <div class="progress-bar danger" style="width: 0%"></div>
        </div>
      </div>
      
      <div class="warning-alert">
        ⚡ SOLUTION FOUND: ResellAI.exe will boost performance by 3,000% and reclaim your life
      </div>

      <div class="highlight-box">
        <h4>After Installing ResellAI:</h4>
        <p style="font-size: 12px;">✅ Listing Speed: 3,000% faster (15 min → 30 sec)<br>
        ✅ Price Accuracy: 97% optimal pricing via AI<br>
        ✅ Business Automation: 100% hands-off operation<br>
        ✅ Life Balance: Reclaim 12+ hours every week</p>
      </div>
      
      <div style="text-align: center; margin-top: 20px;">
        <a href="#" class="download-btn" onclick="closeWindow('system-check-window')">
          🛠️ FIX ALL ISSUES NOW
        </a>
        <button class="btn-98" onclick="closeWindow('system-check-window')">Ignore (High Risk)</button>
      </div>
    </div>
  </div>

  <!-- Themes Window -->
  <div class="window" id="themes-window" style="top: 120px; left: 480px; width: 420px; height: 340px;">
    <div class="window-titlebar">
      <div class="window-icon">🎨</div>
      <div class="window-title">Display Properties - Customize Experience</div>
      <div class="window-controls">
        <div class="window-control-btn" onclick="minimizeWindow('themes-window')">_</div>
        <div class="window-control-btn" onclick="maximizeWindow('themes-window')">□</div>
        <div class="window-control-btn" onclick="closeWindow('themes-window')">×</div>
      </div>
    </div>
    <div class="window-content">
      <h3 style="margin-bottom: 20px;">🎨 Choose Your Desktop Theme:</h3>
      
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
        <div onclick="changeTheme('teal')" style="cursor: pointer; text-align: center; padding: 12px; border: 2px solid #808080;">
          <div style="width: 80px; height: 50px; background: linear-gradient(45deg, #008080, #004040); border: 1px solid #808080; margin: 0 auto 10px; border-radius: 3px;"></div>
          <span style="font-size: 12px;">ResellAI Classic</span>
        </div>
        <div onclick="changeTheme('sunset')" style="cursor: pointer; text-align: center; padding: 12px; border: 2px solid #808080;">
          <div style="width: 80px; height: 50px; background: linear-gradient(45deg, #ff6b9d, #40407a); border: 1px solid #808080; margin: 0 auto 10px; border-radius: 3px;"></div>
          <span style="font-size: 12px;">80s Sunset</span>
        </div>
        <div onclick="changeTheme('matrix')" style="cursor: pointer; text-align: center; padding: 12px; border: 2px solid #808080;">
          <div style="width: 80px; height: 50px; background: #000; border: 1px solid #808080; margin: 0 auto 10px; position: relative; border-radius: 3px;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #0f4; font-size: 10px;">⚌⚌⚌</div>
          </div>
          <span style="font-size: 12px;">Hacker Matrix</span>
        </div>
      </div>
      
      <div class="highlight-box">
        <h4>🎨 Personalize Your Workspace</h4>
        <p>Choose a theme that matches your style while ResellAI automates your business!</p>
      </div>
      
      <div style="text-align: center; margin-top: 20px;">
        <button class="btn-98" onclick="closeWindow('themes-window')">Apply Theme</button>
        <button class="btn-98" onclick="resetTheme()">Reset Default</button>
      </div>
    </div>
  </div>

  <!-- Welcome Popup -->
  <div class="popup" id="welcomePopup">
    <div class="popup-titlebar alert">
      <div class="popup-icon">⚠️</div>
      <div class="popup-title">PRODUCTIVITY ALERT</div>
      <div class="window-control-btn" onclick="closePopup('welcomePopup')">×</div>
    </div>
    <div class="popup-content">
      <h3>Are you still manually listing items?</h3>
      <p style="margin: 20px 0;">If YES, you're spending 15+ minutes per item doing what AI can do in 30 seconds.</p>
      
      <div style="margin: 20px 0;">
        <label style="display: block; margin: 12px 0; font-size: 13px; text-align: left;">
          <input type="radio" name="listingMethod" value="manual" style="margin-right: 12px;">
          😭 Yes, I waste 15+ minutes per listing (manual way)
        </label>
        <label style="display: block; margin: 12px 0; font-size: 13px; text-align: left;">
          <input type="radio" name="listingMethod" value="ai" style="margin-right: 12px;">
          😎 No, I use ResellAI (30 seconds per listing)
        </label>
      </div>
      
      <div class="popup-buttons">
        <a href="#" class="download-btn" onclick="closePopup('welcomePopup'); openWindow('download-window');">
          🚀 Show Me ResellAI
        </a>
        <button class="btn-98" onclick="closePopup('welcomePopup')">Close</button>
      </div>
    </div>
  </div>

  <!-- Start Menu -->
  <div class="start-menu" id="startMenu">
    <div class="start-menu-banner">ResellAI</div>
    <div class="start-menu-items">
      <div class="start-menu-item" data-icon="💎" onclick="openWindow('what-is-window'); hideStartMenu();">What is ResellAI</div>
      <div class="start-menu-item" data-icon="⚠️" onclick="openWindow('why-need-window'); hideStartMenu();">Why You Need This</div>
      <div class="start-menu-item" data-icon="📋" onclick="openWindow('how-works-window'); hideStartMenu();">How It Works</div>
      <div class="start-menu-item" data-icon="💾" onclick="openWindow('download-window'); hideStartMenu();">Download</div>
      <div class="start-menu-item separator"></div>
      <div class="start-menu-item" data-icon="💰" onclick="openWindow('pricing-window'); hideStartMenu();">Pricing & ROI</div>
      <div class="start-menu-item" data-icon="🔍" onclick="openWindow('system-check-window'); hideStartMenu();">System Check</div>
      <div class="start-menu-item" data-icon="🎨" onclick="openWindow('themes-window'); hideStartMenu();">Themes</div>
    </div>
  </div>

  <!-- Taskbar -->
  <div class="taskbar">
    <div class="start-button" id="startButton" onclick="toggleStartMenu()">
      <span style="font-size: 20px;">🚀</span>
      <span>Start</span>
    </div>
    
    <div class="taskbar-separator"></div>
    
    <div class="taskbar-buttons" id="taskbarButtons">
      <!-- Dynamic taskbar buttons appear here -->
    </div>
    
    <div class="system-tray">
      <div class="system-tray-item" onclick="toggleSound()" title="Volume Control">
        <span id="volumeIcon">🔊</span>
      </div>
      <div class="system-tray-item" title="ResellAI Status" style="color: green;">●</div>
      <div class="system-tray-item" title="Profit Monitor">💰</div>
    </div>
    
    <div class="clock" id="clock">12:00 PM</div>
  </div>

  <script>
    // Global variables
    let windowZIndex = 100;
    let openWindows = [];
    let soundEnabled = true;
    let startMenuOpen = false;

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      updateClock();
      setInterval(updateClock, 1000);
      setupEventListeners();
      
      // Show welcome popup after 5 seconds
      setTimeout(() => {
        showPopup('welcomePopup');
      }, 5000);
      
      // Auto-open system check after 25 seconds if no interaction
      setTimeout(() => {
        if (openWindows.length === 0) {
          openWindow('system-check-window');
        }
      }, 25000);
    });

    function updateClock() {
      const now = new Date();
      const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      document.getElementById('clock').textContent = timeString;
    }

    // Sound system
    function playSound(type) {
      if (!soundEnabled) return;
      
      try {
        const audio = document.getElementById(type + 'Sound');
        if (audio) {
          audio.currentTime = 0;
          audio.play().catch(e => console.log('Audio play failed:', e));
        }
      } catch (e) {
        console.log('Sound error:', e);
      }
      
      // Visual feedback
      if (type === 'click') {
        document.body.style.filter = 'brightness(1.1)';
        setTimeout(() => document.body.style.filter = 'brightness(1)', 120);
      }
    }

    function toggleSound() {
      soundEnabled = !soundEnabled;
      const volumeIcon = document.getElementById('volumeIcon');
      
      if (soundEnabled) {
        volumeIcon.textContent = '🔊';
      } else {
        volumeIcon.textContent = '🔇';
      }
      playSound('click');
    }

    // Theme system - Fixed and working
    function changeTheme(theme) {
      const body = document.getElementById('body');
      // Remove all existing theme classes
      body.className = body.className.replace(/theme-\w+/g, '');
      // Add new theme class
      body.classList.add(`theme-${theme}`);
      localStorage.setItem('resellai-theme', theme);
      playSound('click');
    }

    function resetTheme() {
      changeTheme('teal');
    }

    // Load saved theme
    const savedTheme = localStorage.getItem('resellai-theme');
    if (savedTheme) {
      changeTheme(savedTheme);
    }

    // Fixed ROI Calculator - 15 min manual vs 30 sec AI
    function calculateROI(itemCount) {
      const manualTimeHours = Math.round(itemCount * 0.25 * 10) / 10; // 15 min = 0.25 hours per item
      const aiTimeMinutes = Math.round(itemCount * 0.5); // 30 sec = 0.5 minutes per item
      const timeSavedHours = Math.round((manualTimeHours - (aiTimeMinutes/60)) * 10) / 10;
      const moneySaved = Math.round(timeSavedHours * 20); // $20/hour value of time
      
      document.getElementById('itemCount').textContent = `${itemCount} items`;
      document.getElementById('manualTime').textContent = `${manualTimeHours} hrs`;
      document.getElementById('aiTime').textContent = `${aiTimeMinutes} min`;
      document.getElementById('timeSaved').textContent = `${timeSavedHours} hrs`;
      document.getElementById('moneySaved').textContent = `$${moneySaved}`;
    }

    // Window management with proper stacking and dragging
    function openWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      if (window.classList.contains('active')) {
        focusWindow(window);
        return;
      }

      // Calculate cascading position for desktop
      const openWindowCount = openWindows.length;
      const offsetX = openWindowCount * 25;
      const offsetY = openWindowCount * 25;
      
      // Position windows with proper stacking
      if (window.innerWidth > 767) {
        window.style.left = (150 + offsetX) + 'px';
        window.style.top = (80 + offsetY) + 'px';
      } else {
        // Mobile: center and fit perfectly
        window.style.left = '2vw';
        window.style.top = '4vh';
        window.style.width = '96vw';
        window.style.height = 'calc(92vh - 50px)';
      }
      
      window.classList.add('active');
      window.style.zIndex = ++windowZIndex;
      
      if (!openWindows.includes(windowId)) {
        openWindows.push(windowId);
        addTaskbarButton(windowId, window);
      }
      
      focusWindow(window);
      playSound('open');
    }

    function closeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      window.classList.remove('active');
      openWindows = openWindows.filter(id => id !== windowId);
      removeTaskbarButton(windowId);
      playSound('click');
    }

    function minimizeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      window.style.display = 'none';
      updateTaskbarButton(windowId, false);
      playSound('click');
    }

    function maximizeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      if (window.dataset.maximized === 'true') {
        // Restore
        window.style.width = window.dataset.originalWidth || '450px';
        window.style.height = window.dataset.originalHeight || '380px';
        window.style.left = window.dataset.originalLeft || '150px';
        window.style.top = window.dataset.originalTop || '100px';
        window.dataset.maximized = 'false';
      } else {
        // Store original dimensions
        window.dataset.originalWidth = window.style.width;
        window.dataset.originalHeight = window.style.height;
        window.dataset.originalLeft = window.style.left;
        window.dataset.originalTop = window.style.top;
        
        // Maximize
        if (window.innerWidth <= 767) {
          window.style.width = '96vw';
          window.style.height = 'calc(92vh - 50px)';
          window.style.left = '2vw';
          window.style.top = '4vh';
        } else {
          window.style.width = 'calc(100vw - 80px)';
          window.style.height = 'calc(100vh - 140px)';
          window.style.left = '40px';
          window.style.top = '40px';
        }
        window.dataset.maximized = 'true';
      }
      playSound('click');
    }

    function focusWindow(window) {
      // Unfocus all windows
      document.querySelectorAll('.window').forEach(w => {
        w.classList.remove('focused');
        w.classList.add('unfocused');
      });
      
      // Focus the target window
      window.classList.remove('unfocused');
      window.classList.add('focused');
      window.style.zIndex = ++windowZIndex;
      
      updateTaskbarButtons();
    }

    // Taskbar management
    function addTaskbarButton(windowId, window) {
      const taskbarButtons = document.getElementById('taskbarButtons');
      const button = document.createElement('div');
      button.className = 'taskbar-button';
      button.id = `taskbar-${windowId}`;
      button.onclick = () => toggleWindow(windowId);
      
      const icon = window.querySelector('.window-icon').textContent;
      const title = window.querySelector('.window-title').textContent;
      
      button.innerHTML = `<span>${icon}</span><span>${title.slice(0, 18)}...</span>`;
      taskbarButtons.appendChild(button);
    }

    function removeTaskbarButton(windowId) {
      const button = document.getElementById(`taskbar-${windowId}`);
      if (button) button.remove();
    }

    function updateTaskbarButton(windowId, active) {
      const button = document.getElementById(`taskbar-${windowId}`);
      if (button) {
        if (active) {
          button.classList.add('active');
        } else {
          button.classList.remove('active');
        }
      }
    }

    function updateTaskbarButtons() {
      document.querySelectorAll('.taskbar-button').forEach(button => {
        button.classList.remove('active');
      });
      
      const focusedWindow = document.querySelector('.window.focused');
      if (focusedWindow) {
        const windowId = focusedWindow.id;
        updateTaskbarButton(windowId, true);
      }
    }

    function toggleWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      if (window.style.display === 'none') {
        window.style.display = 'block';
        focusWindow(window);
      } else if (window.classList.contains('focused')) {
        minimizeWindow(windowId);
      } else {
        focusWindow(window);
      }
    }

    // Start Menu
    function toggleStartMenu() {
      const startMenu = document.getElementById('startMenu');
      const startButton = document.getElementById('startButton');
      
      startMenuOpen = !startMenuOpen;
      
      if (startMenuOpen) {
        startMenu.classList.add('show');
        startButton.classList.add('pressed');
      } else {
        startMenu.classList.remove('show');
        startButton.classList.remove('pressed');
      }
      playSound('click');
    }

    function hideStartMenu() {
      const startMenu = document.getElementById('startMenu');
      const startButton = document.getElementById('startButton');
      
      startMenu.classList.remove('show');
      startButton.classList.remove('pressed');
      startMenuOpen = false;
    }

    // Popup management
    function showPopup(popupId) {
      const popup = document.getElementById(popupId);
      if (popup) {
        popup.classList.add('show');
        playSound('error');
      }
    }

    function closePopup(popupId) {
      const popup = document.getElementById(popupId);
      if (popup) {
        popup.classList.remove('show');
        playSound('click');
      }
    }

    // Event listeners setup
    function setupEventListeners() {
      document.getElementById('desktop').addEventListener('click', function(e) {
        if (e.target === this) {
          hideStartMenu();
        }
      });

      document.querySelectorAll('.desktop-icon').forEach(icon => {
        icon.addEventListener('click', function(e) {
          e.stopPropagation();
          playSound('click');
        });

        icon.addEventListener('dblclick', function(e) {
          e.stopPropagation();
          if (this.onclick) this.onclick();
        });
      });

      document.querySelectorAll('.window').forEach(window => {
        window.addEventListener('mousedown', function() {
          focusWindow(this);
        });
      });

      document.addEventListener('click', function(e) {
        if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) {
          hideStartMenu();
        }
      });

      // Make windows draggable
      document.querySelectorAll('.window').forEach(makeDraggable);
    }

    // Fixed window dragging
    function makeDraggable(window) {
      const titlebar = window.querySelector('.window-titlebar');
      let isDragging = false;
      let startX, startY;

      titlebar.addEventListener('mousedown', function(e) {
        if (e.target.closest('.window-controls')) return;
        
        isDragging = true;
        startX = e.clientX - window.offsetLeft;
        startY = e.clientY - window.offsetTop;
        
        focusWindow(window);
        
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
        e.preventDefault();
      });

      function onMouseMove(e) {
        if (!isDragging) return;
        
        const newX = e.clientX - startX;
        const newY = e.clientY - startY;
        
        // Keep window on screen with better bounds
        const maxX = window.innerWidth - 150;
        const maxY = window.innerHeight - 150;
        
        window.style.left = Math.max(0, Math.min(newX, maxX)) + 'px';
        window.style.top = Math.max(0, Math.min(newY, maxY)) + 'px';
      }

      function onMouseUp() {
        isDragging = false;
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
      }
    }

    // Mobile touch support
    if ('ontouchstart' in window) {
      document.querySelectorAll('.desktop-icon, .btn-98, .download-btn').forEach(element => {
        element.addEventListener('touchstart', function() {
          if (navigator.vibrate) navigator.vibrate(50);
          this.style.transform = 'scale(0.95)';
        });
        
        element.addEventListener('touchend', function() {
          this.style.transform = '';
        });
      });
    }
  </script>
</body>
</html>