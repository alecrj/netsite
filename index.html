<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>ResellAI - Put Your Business on Autopilot</title>
  
  <style>
    @import url('https://fonts.cdnfonts.com/css/ms-sans-serif');
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'MS Sans Serif', sans-serif;
      font-size: 11px;
      background: linear-gradient(45deg, #008080 0%, #004040 100%);
      height: 100vh;
      overflow: hidden;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: default;
      position: relative;
    }

    /* Loading Screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      color: #00ff00;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Courier New', monospace;
      z-index: 10000;
      animation: fadeOut 1s ease-in-out 4s forwards;
    }

    @keyframes fadeOut {
      to { opacity: 0; visibility: hidden; }
    }

    .boot-text {
      font-size: clamp(12px, 2vw, 16px);
      margin: 10px 0;
      opacity: 0;
      animation: typeIn 0.8s ease-in-out forwards;
    }

    .boot-text:nth-child(1) { animation-delay: 0.5s; }
    .boot-text:nth-child(2) { animation-delay: 1.2s; }
    .boot-text:nth-child(3) { animation-delay: 1.8s; }
    .boot-text:nth-child(4) { animation-delay: 2.8s; }

    @keyframes typeIn {
      to { opacity: 1; }
    }

    .progress-bar {
      width: 300px;
      height: 20px;
      background: #333;
      border: 2px solid #00ff00;
      margin: 20px 0;
      position: relative;
      max-width: 80vw;
    }

    .progress-fill {
      height: 100%;
      background: #00ff00;
      width: 0;
      animation: fillProgress 2s ease-in-out 1.5s forwards;
    }

    @keyframes fillProgress {
      to { width: 100%; }
    }

    /* Theme backgrounds */
    body.theme-teal { 
      background: linear-gradient(45deg, #008080 0%, #004040 100%);
    }
    
    body.theme-sunset { 
      background: linear-gradient(45deg, #ff6b9d 0%, #c44569 25%, #f8b500 50%, #40407a 75%, #706fd3 100%);
      background-size: 400% 400%;
      animation: retro-gradient 8s ease infinite;
    }
    
    body.theme-matrix { 
      background: #000;
      background-image: 
        repeating-linear-gradient(0deg, transparent, transparent 20px, #0f4 21px, #0f4 22px),
        repeating-linear-gradient(90deg, transparent, transparent 20px, #0f4 21px, #0f4 22px);
      background-size: 21px 21px;
    }
    
    body.theme-cat {
      background: linear-gradient(135deg, #FFB6C1 0%, #FFC0CB 25%, #FFE4E1 50%, #FFF0F5 75%, #F0E68C 100%);
      background-size: 400% 400%;
      animation: cat-gradient 6s ease infinite;
      position: relative;
    }
    
    body.theme-cat::before {
      content: "üê± üò∏ üêà üò∫ üê± üò∏ üêà üò∫ üê± üò∏ üêà üò∫ üê± üò∏ üêà üò∫";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      font-size: 24px;
      opacity: 0.1;
      pointer-events: none;
      z-index: -1;
      animation: float-cats 20s linear infinite;
      white-space: pre;
      line-height: 60px;
      overflow: hidden;
    }
    
    @keyframes cat-gradient { 
      0% { background-position: 0% 50%; } 
      50% { background-position: 100% 50%; } 
      100% { background-position: 0% 50%; } 
    }
    
    @keyframes float-cats {
      0% { transform: translateY(100vh) rotate(0deg); }
      100% { transform: translateY(-100vh) rotate(360deg); }
    }

    @keyframes retro-gradient { 
      0% { background-position: 0% 50%; } 
      50% { background-position: 100% 50%; } 
      100% { background-position: 0% 50%; } 
    }

    /* Perfect Mobile Desktop Layout */
    .desktop {
      position: relative;
      height: calc(100vh - 40px);
      padding: 10px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .desktop-icons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      max-width: 100%;
      justify-items: center;
      align-content: start;
      min-height: 100%;
      padding: 10px 0;
    }

    @media (min-width: 768px) {
      .desktop {
        padding: 40px;
        overflow: visible;
        height: calc(100vh - 50px);
      }
      
      .desktop-icons {
        display: block;
        position: relative;
        height: 100%;
      }
    }

    /* Perfect Mobile Icon Sizing */
    .desktop-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 15px 10px;
      cursor: pointer;
      user-select: none;
      width: 140px;
      min-height: 120px;
      background: rgba(255, 255, 255, 0.12);
      border-radius: 12px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
      color: white;
      text-align: center;
    }

    @media (min-width: 768px) {
      .desktop-icon {
        position: absolute;
        width: 80px;
        min-height: 80px;
        background: transparent;
        border: none;
        backdrop-filter: none;
        border-radius: 0;
        box-shadow: none;
        padding: 10px;
      }
    }

    .desktop-icon:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
    }

    @media (min-width: 768px) {
      .desktop-icon:hover {
        background: rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        transform: translateY(-3px);
      }
    }

    /* Desktop positioning for larger screens */
    @media (min-width: 768px) {
      .desktop-icon.pos-1 { top: 20px; left: 20px; }
      .desktop-icon.pos-2 { top: 120px; left: 20px; }
      .desktop-icon.pos-3 { top: 220px; left: 20px; }
      .desktop-icon.pos-4 { top: 20px; right: 20px; }
      .desktop-icon.pos-5 { top: 120px; right: 20px; }
      .desktop-icon.pos-6 { top: 220px; right: 20px; }
      .desktop-icon.pos-7 { top: 320px; left: 20px; }
    }

    /* Folder Icons - Mobile Optimized */
    .folder-icon {
      position: relative;
      width: 60px;
      height: 48px;
      margin-bottom: 12px;
    }

    @media (min-width: 768px) {
      .folder-icon {
        width: 50px;
        height: 40px;
        margin-bottom: 10px;
      }
    }

    .folder-body {
      position: absolute;
      width: 100%;
      height: 75%;
      bottom: 0;
      left: 0;
      background: linear-gradient(135deg, #FFFF80 0%, #FFFF60 30%, #FFFF40 70%, #FFFF20 100%);
      border: 2px solid;
      border-color: #FFFFFF #999999 #999999 #FFFFFF;
      box-shadow: 
        inset 2px 2px 0 #FFFFFF, 
        inset -2px -2px 0 #999999,
        3px 3px 8px rgba(0,0,0,0.4);
      border-radius: 3px;
    }

    .folder-tab {
      position: absolute;
      width: 35%;
      height: 32%;
      top: 0;
      left: 4px;
      background: linear-gradient(135deg, #FFFF80 0%, #FFFF60 30%, #FFFF40 70%, #FFFF20 100%);
      border: 2px solid;
      border-color: #FFFFFF #999999 transparent #FFFFFF;
      border-bottom: none;
      box-shadow: inset 2px 2px 0 #FFFFFF, inset -2px 0 0 #999999;
      border-radius: 3px 3px 0 0;
    }

    /* Special folder variants */
    .folder-icon.download .folder-body, .folder-icon.download .folder-tab {
      background: linear-gradient(135deg, #80FF80 0%, #60FF60 30%, #40DD40 70%, #20BB20 100%);
      animation: pulse-download 3s ease-in-out infinite;
    }

    @keyframes pulse-download {
      0%, 100% { 
        box-shadow: 
          inset 2px 2px 0 #FFFFFF, 
          inset -2px -2px 0 #999999,
          3px 3px 8px rgba(0,0,0,0.4),
          0 0 20px rgba(64,255,64,0.3);
      }
      50% { 
        box-shadow: 
          inset 2px 2px 0 #FFFFFF, 
          inset -2px -2px 0 #999999,
          3px 3px 12px rgba(0,0,0,0.6),
          0 0 30px rgba(64,255,64,0.6);
        transform: scale(1.05);
      }
    }

    .folder-icon.urgent .folder-body, .folder-icon.urgent .folder-tab {
      background: linear-gradient(135deg, #FF8080 0%, #FF6060 30%, #FF4040 70%, #FF2020 100%);
    }

    .folder-icon.system .folder-body, .folder-icon.system .folder-tab {
      background: linear-gradient(135deg, #FFE080 0%, #FFD060 30%, #FFC040 70%, #FFB020 100%);
    }

    /* Icon labels */
    .icon-label {
      font-size: 12px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.9);
      max-width: 120px;
      word-wrap: break-word;
      line-height: 1.2;
      font-weight: bold;
    }

    @media (min-width: 768px) {
      .icon-label {
        font-size: 11px;
        max-width: 80px;
      }
    }

    /* Windows - Perfect Mobile Sizing with Dragging */
    .window {
      position: fixed;
      background: #C0C0C0;
      border: 2px outset #C0C0C0;
      box-shadow: 4px 4px 15px rgba(0,0,0,0.5);
      display: none;
      z-index: 1000;
      min-width: 300px;
      max-width: 95vw;
      max-height: 95vh;
      overflow: hidden;
      
      /* Default desktop sizing */
      width: 550px;
      height: 500px;
      top: 100px;
      left: 150px;
    }

    .window.active {
      display: block;
    }

    .window.focused {
      z-index: 1001;
      border-color: #000080;
    }

    .window.unfocused {
      border-color: #808080;
    }

    @media (max-width: 767px) {
      .window {
        /* Mobile perfect sizing */
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        max-width: 100vw;
        max-height: 100vh;
      }
    }

    .window-header {
      background: linear-gradient(90deg, #0080FF 0%, #0060C0 100%);
      color: white;
      padding: 4px 8px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 28px;
      font-size: 11px;
      flex-shrink: 0;
      cursor: move;
    }

    .window.focused .window-header {
      background: linear-gradient(90deg, #0080FF 0%, #0060C0 100%);
    }

    .window.unfocused .window-header {
      background: linear-gradient(90deg, #808080 0%, #606060 100%);
    }

    @media (max-width: 767px) {
      .window-header {
        height: 32px;
        cursor: default;
      }
    }

    .window-title {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .window-controls {
      display: flex;
      gap: 2px;
      flex-shrink: 0;
    }

    .window-button {
      width: 20px;
      height: 18px;
      background: #C0C0C0;
      border: 1px outset #C0C0C0;
      font-size: 12px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: black;
    }

    @media (max-width: 767px) {
      .window-button {
        width: 24px;
        height: 22px;
        font-size: 14px;
      }
    }

    .window-button:hover {
      background: #d0d0d0;
    }

    .window-button:active {
      border: 1px inset #C0C0C0;
    }

    .window-content {
      padding: 16px;
      background: #C0C0C0;
      height: calc(100% - 28px);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      font-size: 12px;
      line-height: 1.4;
    }

    @media (max-width: 767px) {
      .window-content {
        padding: 12px;
        font-size: 13px;
        height: calc(100% - 32px);
      }
    }

    /* Taskbar - Mobile Optimized with Window Buttons */
    .taskbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40px;
      background: linear-gradient(180deg, #D0D0D0 0%, #A0A0A0 100%);
      border-top: 2px outset #C0C0C0;
      display: flex;
      align-items: center;
      padding: 0 8px;
      z-index: 5000;
      font-size: 11px;
    }

    @media (min-width: 768px) {
      .taskbar {
        height: 50px;
        padding: 0 10px;
      }
    }

    .start-button {
      background: linear-gradient(180deg, #DFDFDF 0%, #C0C0C0 45%, #A0A0A0 55%, #C0C0C0 100%);
      border: 1px outset #C0C0C0;
      padding: 4px 16px;
      font-weight: bold;
      cursor: pointer;
      margin-right: 6px;
      font-size: 11px;
      height: 28px;
      display: flex;
      align-items: center;
      gap: 4px;
      flex-shrink: 0;
      font-family: 'MS Sans Serif', sans-serif;
      color: #000;
    }

    .start-button:hover {
      background: linear-gradient(180deg, #E8E8E8 0%, #D0D0D0 45%, #B0B0B0 55%, #D0D0D0 100%);
    }

    @media (max-width: 767px) {
      .start-button {
        padding: 4px 12px;
        height: 24px;
        font-size: 10px;
      }
    }

    .start-button:active {
      border: 1px inset #C0C0C0;
      background: linear-gradient(180deg, #A0A0A0 0%, #808080 45%, #606060 55%, #808080 100%);
    }

    .taskbar-separator {
      width: 2px; 
      height: 24px; 
      border-left: 1px inset #C0C0C0; 
      margin: 0 4px;
    }

    .taskbar-buttons {
      display: flex;
      gap: 2px;
      flex: 1;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 2px;
    }

    .taskbar-buttons::-webkit-scrollbar {
      display: none;
    }

    .taskbar-button {
      background: linear-gradient(180deg, #DFDFDF 0%, #C0C0C0 45%, #A0A0A0 55%, #C0C0C0 100%);
      border: 1px outset #C0C0C0;
      padding: 4px 8px;
      font-weight: normal;
      cursor: pointer;
      font-size: 11px;
      height: 28px;
      display: flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      min-width: 120px;
      max-width: 160px;
      overflow: hidden;
      text-overflow: ellipsis;
      flex-shrink: 0;
      color: #000;
      font-family: 'MS Sans Serif', sans-serif;
    }

    .taskbar-button:hover {
      background: linear-gradient(180deg, #E8E8E8 0%, #D0D0D0 45%, #B0B0B0 55%, #D0D0D0 100%);
    }

    .taskbar-button.active {
      border: 1px inset #C0C0C0;
      background: linear-gradient(180deg, #A0A0A0 0%, #808080 45%, #606060 55%, #808080 100%);
      color: #000;
    }

    @media (max-width: 767px) {
      .taskbar-button {
        min-width: 100px;
        max-width: 120px;
        font-size: 10px;
        height: 24px;
      }
    }

    .taskbar-time {
      margin-left: auto;
      font-size: 11px;
      padding: 4px 8px;
      background: #D0D0D0;
      border: 1px inset #C0C0C0;
      min-width: 80px;
      text-align: center;
      flex-shrink: 0;
      font-weight: bold;
      color: #000;
    }

    @media (max-width: 767px) {
      .taskbar-time {
        font-size: 10px;
        min-width: 70px;
        padding: 2px 6px;
      }
    }

    /* Start Menu */
    .start-menu {
      position: fixed;
      bottom: 42px;
      left: 2px;
      width: 200px;
      background: #C0C0C0;
      border: 2px outset #C0C0C0;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
      display: none;
      z-index: 6000;
    }

    .start-menu-header {
      background: linear-gradient(90deg, #0080FF 0%, #0060C0 100%);
      color: white;
      padding: 8px 12px;
      font-weight: bold;
      font-size: 12px;
    }

    .start-menu-item {
      padding: 8px 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      border-bottom: 1px solid #A0A0A0;
    }

    .start-menu-item:hover {
      background: #0080FF;
      color: white;
    }

    /* Content Styles */
    .success-alert {
      background: #E0FFE0;
      border: 2px inset #C0C0C0;
      padding: 12px;
      margin: 15px 0;
      font-weight: bold;
      color: #008000;
      border-radius: 0;
    }

    .highlight-box {
      background: linear-gradient(135deg, #FFE080 0%, #FFD060 100%);
      border: 2px outset #C0C0C0;
      padding: 15px;
      margin: 15px 0;
      font-weight: bold;
    }

    .feature-list {
      background: #F0F0F0;
      border: 2px inset #C0C0C0;
      padding: 15px;
      margin: 15px 0;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 20px 0;
    }

    @media (max-width: 768px) {
      .feature-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }
    }

    .feature-card {
      background: white;
      border: 2px inset #C0C0C0;
      padding: 16px;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .feature-card:hover {
      transform: translateY(-2px);
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
    }

    .feature-card h4 {
      color: #000080;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .feature-card p {
      color: #666;
      font-size: 12px;
      line-height: 1.4;
    }

    .button {
      background: linear-gradient(135deg, #C0C0C0 0%, #A0A0A0 100%);
      border: 2px outset #C0C0C0;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: bold;
      font-size: 12px;
      margin: 5px;
      display: inline-block;
      font-family: inherit;
    }

    .button:active {
      border: 2px inset #C0C0C0;
    }

    .button.primary {
      background: linear-gradient(135deg, #0080FF 0%, #0060C0 100%);
      color: white;
    }

    .button.download {
      background: linear-gradient(135deg, #00C000 0%, #008000 100%);
      color: white;
      font-size: 14px;
      padding: 10px 20px;
      animation: pulse-button 2s ease-in-out infinite;
    }

    @keyframes pulse-button {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      margin: 20px 0;
    }

    .stat-card {
      background: white;
      border: 2px inset #C0C0C0;
      padding: 12px 8px;
      text-align: center;
    }

    .stat-number {
      font-size: clamp(16px, 3vw, 20px);
      font-weight: bold;
      color: #0080FF;
    }

    .stat-label {
      font-size: clamp(8px, 1.5vw, 10px);
      color: #666;
      margin-top: 4px;
    }

    .video-placeholder {
      background: #000;
      border: 2px inset #C0C0C0;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      margin: 20px 0;
      position: relative;
      font-size: 14px;
    }

    .video-placeholder::before {
      content: "üìπ";
      font-size: 2em;
      margin-right: 10px;
    }

    /* You've Got Mail Notification */
    .mail-notification {
      position: fixed;
      top: 60px;
      right: 20px;
      background: #FFFF80;
      border: 2px outset #C0C0C0;
      padding: 12px;
      border-radius: 0;
      box-shadow: 4px 4px 10px rgba(0,0,0,0.5);
      font-weight: bold;
      z-index: 3000;
      cursor: pointer;
      display: none;
      animation: mail-bounce 0.5s ease-out;
    }

    @keyframes mail-bounce {
      0% { transform: translateY(-50px) scale(0.8); opacity: 0; }
      50% { transform: translateY(10px) scale(1.1); }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }

    /* Clippy Assistant */
    .clippy-assistant {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 200px;
      background: #FFFFA0;
      border: 2px solid #000;
      border-radius: 15px;
      padding: 12px;
      font-size: 11px;
      display: none;
      z-index: 3000;
      animation: clippy-appear 0.6s ease-out;
    }

    @keyframes clippy-appear {
      0% { transform: scale(0) rotate(180deg); opacity: 0; }
      50% { transform: scale(1.1) rotate(-10deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    .clippy-character {
      width: 40px;
      height: 40px;
      float: left;
      margin-right: 10px;
      background: linear-gradient(45deg, #C0C0C0, #808080);
      border-radius: 50% 50% 50% 10px;
      position: relative;
      animation: clippy-wiggle 2s ease-in-out infinite;
    }

    @keyframes clippy-wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(5deg); }
      75% { transform: rotate(-5deg); }
    }

    .clippy-character::before {
      content: "üìé";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
    }

    .clippy-close {
      float: right;
      cursor: pointer;
      font-weight: bold;
      width: 16px;
      height: 16px;
      background: #FF4040;
      color: white;
      text-align: center;
      line-height: 14px;
      font-size: 10px;
    }

    /* Enhanced Scandalous Growth Popup */
    .growth-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      max-height: 80vh;
      background: #FF1493;
      border: 3px solid #DC143C;
      box-shadow: 8px 8px 25px rgba(0,0,0,0.7);
      z-index: 4000;
      display: none;
      animation: popup-flash 0.8s ease-out;
      overflow: hidden;
    }

    @keyframes popup-flash {
      0% { 
        transform: translate(-50%, -50%) scale(0.3) rotate(15deg); 
        opacity: 0; 
        filter: hue-rotate(0deg) brightness(2);
      }
      30% { 
        transform: translate(-50%, -50%) scale(1.15) rotate(-5deg); 
        filter: hue-rotate(180deg) brightness(1.5);
      }
      60% { 
        transform: translate(-50%, -50%) scale(0.95) rotate(2deg); 
        filter: hue-rotate(360deg) brightness(1.2);
      }
      100% { 
        transform: translate(-50%, -50%) scale(1) rotate(0deg); 
        opacity: 1; 
        filter: hue-rotate(0deg) brightness(1);
      }
    }

    .growth-popup-header {
      background: linear-gradient(45deg, #FF1493 0%, #DC143C 25%, #FF69B4 50%, #FF1493 75%, #DC143C 100%);
      background-size: 200% 200%;
      animation: rainbow-gradient 2s ease infinite;
      color: white;
      padding: 12px;
      font-weight: bold;
      text-align: center;
      font-size: 16px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      border-bottom: 2px solid #8B0000;
    }

    @keyframes rainbow-gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .growth-popup-content {
      padding: 20px;
      background: linear-gradient(135deg, #FFB6C1 0%, #FF69B4 50%, #FFB6C1 100%);
      color: #000080;
      font-weight: bold;
      line-height: 1.4;
      max-height: 400px;
      overflow-y: auto;
    }

    .growth-story {
      background: rgba(255, 255, 255, 0.3);
      border: 1px solid #FF1493;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      font-size: 11px;
      line-height: 1.5;
    }

    .testimonial {
      background: rgba(255, 255, 255, 0.5);
      border-left: 4px solid #32CD32;
      padding: 10px 15px;
      margin: 12px 0;
      font-style: italic;
      position: relative;
    }

    .testimonial::before {
      content: "üí∞";
      position: absolute;
      left: -12px;
      top: 8px;
      background: #32CD32;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }

    .growth-popup-buttons {
      padding: 18px;
      text-align: center;
      background: linear-gradient(135deg, #FFB6C1 0%, #FF1493 100%);
      border-top: 2px solid #8B0000;
    }

    .growth-popup button {
      background: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
      color: white;
      border: 2px outset #32CD32;
      padding: 10px 18px;
      margin: 0 6px 8px 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 13px;
      border-radius: 4px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      animation: button-throb 1.5s ease-in-out infinite;
    }

    @keyframes button-throb {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); box-shadow: 0 0 15px rgba(50, 205, 50, 0.6); }
    }

    .growth-popup button:active {
      border: 2px inset #32CD32;
      transform: scale(0.98);
    }

    .growth-popup button.decline {
      background: linear-gradient(135deg, #FF4500 0%, #B22222 100%);
      border: 2px outset #FF4500;
      animation: none;
    }

    .growth-popup button.decline:active {
      border: 2px inset #FF4500;
    }

    /* Virus Popup */
    .virus-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #C0C0C0;
      border: 2px outset #C0C0C0;
      box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.5);
      z-index: 9999;
      display: none;
      width: 90%;
      max-width: 400px;
      animation: virusShake 0.5s ease-in-out;
    }

    @keyframes virusShake {
      0%, 100% { transform: translate(-50%, -50%); }
      25% { transform: translate(-52%, -48%); }
      75% { transform: translate(-48%, -52%); }
    }

    .virus-header {
      background: red;
      color: white;
      padding: 8px 12px;
      font-weight: bold;
      font-size: 11px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .virus-content {
      padding: 20px;
      text-align: center;
    }

    .virus-icon {
      font-size: 3em;
      color: red;
      margin-bottom: 10px;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .virus-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }

    @media (max-width: 767px) {
      .growth-popup {
        width: 95vw;
        max-width: 380px;
      }
      
      .mail-notification {
        top: 40px;
        right: 10px;
        font-size: 10px;
        padding: 8px;
      }
      
      .clippy-assistant {
        bottom: 60px;
        right: 10px;
        width: 180px;
        font-size: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading-screen" id="loadingScreen">
    <div class="boot-text">ResellAI OS v3.0 Loading...</div>
    <div class="boot-text">Initializing AI modules...</div>
    <div class="boot-text">Loading eBay integration...</div>
    <div class="progress-bar">
      <div class="progress-fill"></div>
    </div>
    <div class="boot-text">Ready to revolutionize reselling!</div>
  </div>

  <!-- Desktop -->
  <div class="desktop" id="desktop">
    <div class="desktop-icons">
      <!-- What is ResellAI -->
      <div class="desktop-icon pos-1" onclick="openWindow('main-window')">
        <div class="folder-icon">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">ResellAI</div>
      </div>

      <!-- Features -->
      <div class="desktop-icon pos-2" onclick="openWindow('features-window')">
        <div class="folder-icon urgent">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">AI Features</div>
      </div>

      <!-- Pricing -->
      <div class="desktop-icon pos-3" onclick="openWindow('pricing-window')">
        <div class="folder-icon system">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Pricing</div>
      </div>

      <!-- Download ResellAI -->
      <div class="desktop-icon pos-4" onclick="openWindow('download-window')">
        <div class="folder-icon download">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Get App</div>
      </div>

      <!-- System Alert -->
      <div class="desktop-icon pos-5" onclick="showVirusPopup()">
        <div class="folder-icon urgent">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">System Alert</div>
      </div>

      <!-- Themes -->
      <div class="desktop-icon pos-6" onclick="openWindow('themes-window')">
        <div class="folder-icon">
          <div class="folder-tab"></div>
          <div class="folder-body"></div>
        </div>
        <div class="icon-label">Themes</div>
      </div>

      <!-- Sound Toggle -->
      <div class="desktop-icon pos-7" onclick="toggleSound()">
        <div class="folder-icon">
          <div class="folder-tab"></div>
          <div class="folder-body" style="display: flex; align-items: center; justify-content: center; font-size: 24px;" id="sound-icon">
            üì¢
          </div>
        </div>
        <div class="icon-label" id="sound-label">Sound: ON</div>
      </div>
    </div>
  </div>

  <!-- Mail Notification -->
  <div class="mail-notification" id="mailNotification" onclick="hideMailNotification()">
    üìß You've Got Mail! New ResellAI profit reports available!
  </div>

  <!-- Clippy Assistant -->
  <div class="clippy-assistant" id="clippyAssistant">
    <div class="clippy-close" onclick="hideClippy()">√ó</div>
    <div class="clippy-character"></div>
    <div style="clear: both; padding-top: 5px;">
      <strong>It looks like you're trying to grow your business!</strong><br><br>
      Would you like help putting your reselling on complete autopilot? I can show you how ResellAI handles everything automatically! 
      <br><br>
      <em>*winks knowingly*</em>
    </div>
  </div>

  <!-- Enhanced Scandalous Growth Popup -->
  <div class="growth-popup" id="growthPopup">
    <div class="growth-popup-header">
      üî• HOT BUSINESS SINGLES IN YOUR AREA! üî•
    </div>
    <div class="growth-popup-content">
      <div style="text-align: center; font-size: 16px; margin-bottom: 15px; color: #8B0000;">
        <strong>These Local Businesses Are Getting ROCK HARD Results! üòè</strong>
      </div>
      
      <div class="growth-story">
        <strong>üçë Sarah from Tampa - Premium Denim Co.</strong><br>
        "I was struggling to get my jeans business <em>up</em> before ResellAI. Now I'm experiencing <strong>MASSIVE growth</strong> - went from $2K to $15K monthly! My business is so <em>hard working</em> now, I barely have to touch it. The automated listings get customers <strong>hot and bothered</strong> to buy!" 
        <div style="color: #008000; font-weight: bold; margin-top: 8px;">üí∞ 500% Growth in 3 months!</div>
      </div>

      <div class="testimonial">
        <strong>"My tight margins became THROBBING profits!"</strong><br>
        - Mike, Hot Button Apparel (Jacksonville)<br>
        <span style="color: #008000;">Now earning $8,247/month passively!</span>
      </div>

      <div class="growth-story">
        <strong>These businesses are getting HARDER and BIGGER every day:</strong><br>
        üî• <strong>Stiff Competition Clothing</strong> - UP 847% in 6 months<br>
        üí™ <strong>Rigid Denim Works</strong> - ROCK SOLID $12K/month profits<br>
        üçÜ <strong>Big Growth Apparel</strong> - SWELLING to new heights daily<br>
        üå∂Ô∏è <strong>Spicy Threads</strong> - SO HOT they can't keep inventory!
      </div>

      <div style="background: rgba(255,255,255,0.8); padding: 12px; margin: 15px 0; border-radius: 8px; border: 2px dashed #FF1493;">
        <div style="text-align: center; font-size: 14px; color: #8B0000;">
          <strong>üî• WARNING: This Growth May Cause Excitement! üî•</strong><br>
          <span style="font-size: 11px;">Side effects include: Uncontrollable profit increases, freedom from manual work, and neighbors asking about your sudden success</span>
        </div>
      </div>

      <div style="text-align: center; color: #000080; font-weight: bold; font-size: 13px;">
        Your business could be this <strong><em>HARD</em></strong> working too!<br>
        <span style="font-size: 11px;">*Results not typical. Individual performance may vary. Growth measured in business metrics.*</span>
      </div>
    </div>
    <div class="growth-popup-buttons">
      <button onclick="acceptGrowth()">YES! I Want This Growth! üçÜüí¶</button>
      <button class="decline" onclick="hideGrowthPopup()">No thanks... I'll stay small üòî</button>
    </div>
  </div>

  <!-- Virus Popup -->
  <div class="virus-popup" id="virusPopup">
    <div class="virus-header">
      <span>‚ö†Ô∏è SYSTEM ALERT - URGENT!</span>
      <div class="window-button" onclick="closeVirusPopup()">√ó</div>
    </div>
    <div class="virus-content">
      <div class="virus-icon">ü¶†</div>
      <h3 style="color: red; margin-bottom: 10px;">VIRUS DETECTED!</h3>
      <p><strong>SLOW_LISTING.EXE</strong> is draining your profits!</p>
      <p style="margin: 10px 0;">This virus causes manual listing, wasted time, and reduced earnings!</p>
      <p style="color: green; font-weight: bold;">Click "Remove Virus" to install ResellAI protection!</p>
      
      <div class="virus-buttons">
        <button class="button download" onclick="openWindow('download-window'); closeVirusPopup(); playSound('success');">
          üõ°Ô∏è Remove Virus
        </button>
        <button class="button" onclick="closeVirusPopup()">Ignore (Not Recommended)</button>
      </div>
    </div>
  </div>

  <!-- Windows -->

  <!-- Main ResellAI Window -->
  <div class="window" id="main-window" style="top: 100px; left: 100px; width: 600px; height: 500px;">
    <div class="window-header">
      <div class="window-title">
        <span>ü§ñ</span>
        <span>ResellAI - Turn Photos Into Profit</span>
      </div>
      <div class="window-controls">
        <div class="window-button" onclick="minimizeWindow('main-window')">_</div>
        <div class="window-button" onclick="maximizeWindow('main-window')">‚ñ°</div>
        <div class="window-button" onclick="closeWindow('main-window')">√ó</div>
      </div>
    </div>
    <div class="window-content">
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: clamp(18px, 4vw, 24px); color: #000080; margin-bottom: 10px; font-weight: bold;">üöÄ The AI That Sells For You</h1>
        <p style="font-size: clamp(12px, 2.5vw, 16px); color: #666; margin-bottom: 20px; line-height: 1.4;">Take a photo. Get a listing. Make money. ResellAI does everything from writing descriptions to pricing your items using advanced AI.</p>
        
        <div class="video-placeholder">
          <span>App Demo Video Coming Soon</span>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number">5x</div>
            <div class="stat-label">Faster Listings</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">98%</div>
            <div class="stat-label">Accuracy Rate</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">$500</div>
            <div class="stat-label">Avg Monthly Saved</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">10K+</div>
            <div class="stat-label">Happy Sellers</div>
          </div>
        </div>

        <div class="highlight-box">
          <h4 style="color: #000080; margin-bottom: 8px;">üéØ Perfect For:</h4>
          <p>eBay sellers, thrift flippers, garage sale pros, estate sale hunters, and anyone who wants to 5x their reselling speed!</p>
        </div>

        <div style="margin-top: 20px;">
          <button class="button download" onclick="openWindow('download-window')">
            üì± Download Free Now
          </button>
          <button class="button" onclick="openWindow('features-window')">See Features</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Features Window -->
  <div class="window" id="features-window" style="top: 150px; left: 200px; width: 550px; height: 450px;">
    <div class="window-header">
      <div class="window-title">
        <span>‚ú®</span>
        <span>ResellAI Features - AI Magic for Resellers</span>
      </div>
      <div class="window-controls">
        <div class="window-button" onclick="minimizeWindow('features-window')">_</div>
        <div class="window-button" onclick="maximizeWindow('features-window')">‚ñ°</div>
        <div class="window-button" onclick="closeWindow('features-window')">√ó</div>
      </div>
    </div>
    <div class="window-content">
      <h3 style="color: #000080; margin-bottom: 16px;">üß† AI-Powered Listing Engine</h3>
      
      <div class="feature-grid">
        <div class="feature-card">
          <h4>üì∏ Photo-to-Listing AI</h4>
          <p>Upload photos and watch AI identify brand, model, condition, and more with computer vision</p>
        </div>
        
        <div class="feature-card">
          <h4>üßæ Auto-Generated Content</h4>
          <p>AI writes high-converting, eBay-optimized titles and descriptions that sell fast</p>
        </div>
        
        <div class="feature-card">
          <h4>üí∞ Smart Pricing</h4>
          <p>Automatically fetches sold listings and recommends pricing for maximum profit</p>
        </div>
        
        <div class="feature-card">
          <h4>üõí One-Tap Publishing</h4>
          <p>Post live to your eBay account instantly - no copy/paste needed</p>
        </div>
        
        <div class="feature-card">
          <h4>üîç Rare Item Detection</h4>
          <p>AI estimates value for vintage and niche items with no sold comps</p>
        </div>
        
        <div class="feature-card">
          <h4>üìä Usage Tracking</h4>
          <p>Monitor your listings, track success rates, and scale your business</p>
        </div>
      </div>

      <div class="highlight-box">
        <h4 style="color: #000080; margin-bottom: 8px;">‚ö° The Result:</h4>
        <p><strong>"Go from pile of product photos to fully live eBay listings in minutes ‚Äî no research, no writing, no stress."</strong></p>
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <button class="button download" onclick="triggerGrowthPopup()">
          üöÄ Start Selling Smarter
        </button>
      </div>
    </div>
  </div>

  <!-- Pricing Window -->
  <div class="window" id="pricing-window" style="top: 200px; left: 300px; width: 500px; height: 400px;">
    <div class="window-header">
      <div class="window-title">
        <span>üíé</span>
        <span>ResellAI Pricing - Free to Start!</span>
      </div>
      <div class="window-controls">
        <div class="window-button" onclick="minimizeWindow('pricing-window')">_</div>
        <div class="window-button" onclick="maximizeWindow('pricing-window')">‚ñ°</div>
        <div class="window-button" onclick="closeWindow('pricing-window')">√ó</div>
      </div>
    </div>
    <div class="window-content">
      <h3 style="color: #000080; margin-bottom: 16px; text-align: center;">Choose Your Plan</h3>
      
      <div class="feature-grid">
        <div class="feature-card">
          <h4>üÜì Free</h4>
          <p><strong>$0/month</strong></p>
          <p>‚Ä¢ 5 listings per month<br>‚Ä¢ Basic AI features<br>‚Ä¢ eBay integration<br>‚Ä¢ Perfect for side hustlers</p>
        </div>
        
        <div class="feature-card" style="border: 3px solid #FF6B35;">
          <h4>‚≠ê Starter</h4>
          <p><strong>$19/month</strong></p>
          <p>‚Ä¢ 50 listings per month<br>‚Ä¢ Advanced AI analysis<br>‚Ä¢ Priority pricing data<br>‚Ä¢ Email support</p>
        </div>
        
        <div class="feature-card">
          <h4>üöÄ Pro</h4>
          <p><strong>$49/month</strong></p>
          <p>‚Ä¢ 250 listings per month<br>‚Ä¢ Premium AI features<br>‚Ä¢ Bulk operations<br>‚Ä¢ Phone support</p>
        </div>
      </div>

      <div class="highlight-box">
        <h4 style="color: #000080; margin-bottom: 8px;">üí° Pro Tip:</h4>
        <p>Most users save $500+ per month in VA costs and listing time. ResellAI pays for itself instantly!</p>
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <button class="button download" onclick="openWindow('download-window')">
          üíé Start Free Trial
        </button>
      </div>
    </div>
  </div>

  <!-- Download Window -->
  <div class="window" id="download-window" style="top: 80px; left: 400px; width: 450px; height: 350px;">
    <div class="window-header">
      <div class="window-title">
        <span>üì±</span>
        <span>Get ResellAI Now - iOS & Android</span>
      </div>
      <div class="window-controls">
        <div class="window-button" onclick="minimizeWindow('download-window')">_</div>
        <div class="window-button" onclick="maximizeWindow('download-window')">‚ñ°</div>
        <div class="window-button" onclick="closeWindow('download-window')">√ó</div>
      </div>
    </div>
    <div class="window-content">
      <div style="text-align: center;">
        <h3 style="margin-bottom: 16px; color: #000080;">üéØ Ready to 5x Your Reselling Speed?</h3>
        
        <div class="video-placeholder" style="height: 120px; margin: 16px 0;">
          <span>App Preview Video</span>
        </div>
        
        <p style="margin-bottom: 20px; font-weight: bold;">Join 10,000+ sellers already using ResellAI!</p>
        
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
          <button class="button download" onclick="window.open('https://apps.apple.com/placeholder', '_blank'); playSound('success');">
            üçé iOS App Store
          </button>
          <button class="button download" onclick="window.open('https://play.google.com/placeholder', '_blank'); playSound('success');">
            ü§ñ Google Play
          </button>
        </div>
        
        <div class="success-alert" style="margin-top: 16px;">
          <p style="font-size: 11px;"><strong>‚úÖ Free to download</strong><br>
          ‚úÖ No credit card required<br>
          ‚úÖ 5 free listings to get started</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Themes Window -->
  <div class="window" id="themes-window" style="top: 120px; left: 250px; width: 400px; height: 300px;">
    <div class="window-header">
      <div class="window-title">
        <span>üé®</span>
        <span>Desktop Themes</span>
      </div>
      <div class="window-controls">
        <div class="window-button" onclick="minimizeWindow('themes-window')">_</div>
        <div class="window-button" onclick="maximizeWindow('themes-window')">‚ñ°</div>
        <div class="window-button" onclick="closeWindow('themes-window')">√ó</div>
      </div>
    </div>
    <div class="window-content">
      <h2 style="color: #000080; margin-bottom: 20px;">üé® Choose Your Desktop Theme</h2>
      
      <p style="margin-bottom: 20px;">Customize your ResellAI experience with these retro themes:</p>
      
      <div style="display: flex; gap: 15px; flex-wrap: wrap; margin: 20px 0;">
        <button class="button" onclick="changeTheme('teal')" style="background: linear-gradient(45deg, #008080, #004040); color: white;">
          üåä Classic Teal
        </button>
        <button class="button" onclick="changeTheme('sunset')" style="background: linear-gradient(45deg, #ff6b9d, #f8b500); color: white;">
          üåÖ Retro Sunset
        </button>
        <button class="button" onclick="changeTheme('matrix')" style="background: #000; color: #0f4;">
          üíö Matrix Code
        </button>
        <button class="button" onclick="changeTheme('cat')" style="background: linear-gradient(135deg, #FFB6C1, #FFC0CB); color: #8B0000;">
          üê± Kawaii Cats
        </button>
      </div>
      
      <div class="success-alert">
        ‚ú® Themes are automatically saved to your preferences!
      </div>
    </div>
  </div>

  <!-- Start Menu -->
  <div class="start-menu" id="startMenu">
    <div class="start-menu-header">ResellAI OS</div>
    <div class="start-menu-item" onclick="openWindow('main-window')">
      <span>ü§ñ</span>
      <span>ResellAI</span>
    </div>
    <div class="start-menu-item" onclick="openWindow('features-window')">
      <span>‚ú®</span>
      <span>AI Features</span>
    </div>
    <div class="start-menu-item" onclick="openWindow('pricing-window')">
      <span>üíé</span>
      <span>Pricing</span>
    </div>
    <div class="start-menu-item" onclick="openWindow('download-window')">
      <span>üì±</span>
      <span>Get App</span>
    </div>
    <div class="start-menu-item" onclick="showAbout()">
      <span>‚ÑπÔ∏è</span>
      <span>About</span>
    </div>
  </div>

  <!-- Taskbar -->
  <div class="taskbar">
    <div class="start-button" onclick="toggleStartMenu()">
      <span style="font-size: 14px;">üöÄ</span>
      <span>Start</span>
    </div>
    <div class="taskbar-separator"></div>
    <div class="taskbar-buttons" id="taskbarButtons">
      <!-- Dynamic window buttons will be added here -->
    </div>
    <div class="taskbar-time" id="current-time">
      12:34 PM
    </div>
  </div>

  <script>
    // Global variables
    let openWindows = [];
    let windowZIndex = 1000;
    let startMenuOpen = false;
    let soundEnabled = true;

    // Sound effects using Web Audio API
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    const sounds = {
      click: () => createBeep(800, 0.1, 0.1),
      open: () => createBeep(600, 0.2, 0.1),
      close: () => createBeep(400, 0.2, 0.1),
      success: () => createChord([523, 659, 784], 0.3, 0.2),
      alert: () => createBeep(1000, 0.5, 0.1)
    };

    function createBeep(frequency, duration, volume = 0.1) {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = frequency;
      oscillator.type = 'square';
      
      gainNode.gain.setValueAtTime(0, audioContext.currentTime);
      gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
      gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration);
    }

    function createChord(frequencies, duration, volume = 0.1) {
      frequencies.forEach(freq => createBeep(freq, duration, volume / frequencies.length));
    }

    function playSound(soundName) {
      if (!soundEnabled) return; // Don't play if sound is disabled
      
      if (audioContext.state === 'suspended') {
        audioContext.resume();
      }
      if (sounds[soundName]) {
        sounds[soundName]();
      }
    }

    // Sound toggle functionality
    function toggleSound() {
      soundEnabled = !soundEnabled;
      const soundIcon = document.getElementById('sound-icon');
      const soundLabel = document.getElementById('sound-label');
      
      if (soundEnabled) {
        soundIcon.textContent = 'üì¢';
        soundLabel.textContent = 'Sound: ON';
        soundIcon.parentElement.style.background = 'linear-gradient(135deg, #FFFF80 0%, #FFFF60 30%, #FFFF40 70%, #FFFF20 100%)';
        // Play a test sound when enabling
        playSound('click');
      } else {
        soundIcon.textContent = 'üîá';
        soundLabel.textContent = 'Sound: OFF';
        soundIcon.parentElement.style.background = 'linear-gradient(135deg, #FF8080 0%, #FF6060 30%, #FF4040 70%, #FF2020 100%)';
      }
      
      // Save preference
      localStorage.setItem('soundEnabled', soundEnabled);
    }

    // Load saved sound preference
    const savedSoundEnabled = localStorage.getItem('soundEnabled');
    if (savedSoundEnabled !== null) {
      soundEnabled = savedSoundEnabled === 'true';
      if (!soundEnabled) {
        // Update UI to show sound is off
        setTimeout(() => {
          const soundIcon = document.getElementById('sound-icon');
          const soundLabel = document.getElementById('sound-label');
          if (soundIcon && soundLabel) {
            soundIcon.textContent = 'üîá';
            soundLabel.textContent = 'Sound: OFF';
            soundIcon.parentElement.style.background = 'linear-gradient(135deg, #FF8080 0%, #FF6060 30%, #FF4040 70%, #FF2020 100%)';
          }
        }, 100);
      }
    }

    // Window management with dragging and taskbar
    function openWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      playSound('open');
      closeStartMenu();

      // If window is already open, just focus it
      if (openWindows.includes(windowId)) {
        if (window.style.display === 'none') {
          window.style.display = 'block';
        }
        focusWindow(window);
        return;
      }

      // Calculate cascading position for desktop
      const openWindowCount = openWindows.length;
      const offsetX = openWindowCount * 30;
      const offsetY = openWindowCount * 30;
      
      // Position windows with proper stacking (desktop only)
      if (window.innerWidth > 767) {
        const startX = 100 + offsetX;
        const startY = 100 + offsetY;
        
        // Keep within screen bounds
        const maxX = window.innerWidth - 600;
        const maxY = window.innerHeight - 550;
        
        window.style.left = Math.min(startX, Math.max(50, maxX)) + 'px';
        window.style.top = Math.min(startY, Math.max(50, maxY)) + 'px';
      }
      
      // Show and configure window
      window.classList.add('active');
      window.style.display = 'block';
      window.style.zIndex = ++windowZIndex;
      
      // Add to open windows and create taskbar button
      openWindows.push(windowId);
      addTaskbarButton(windowId, window);
      
      // Focus and make draggable
      focusWindow(window);
      makeDraggable(window);
    }

    function closeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      playSound('close');
      window.classList.remove('active');
      window.style.display = 'none';
      openWindows = openWindows.filter(id => id !== windowId);
      removeTaskbarButton(windowId);
      
      // Focus another window if available
      if (openWindows.length > 0) {
        const lastWindow = document.getElementById(openWindows[openWindows.length - 1]);
        if (lastWindow) focusWindow(lastWindow);
      }
    }

    function minimizeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      playSound('click');
      window.style.display = 'none';
      updateTaskbarButtons();
      
      // Focus another window if available
      const visibleWindows = openWindows.filter(id => {
        const w = document.getElementById(id);
        return w && w.style.display !== 'none';
      });
      
      if (visibleWindows.length > 0) {
        const nextWindow = document.getElementById(visibleWindows[visibleWindows.length - 1]);
        if (nextWindow) focusWindow(nextWindow);
      }
    }

    function maximizeWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      playSound('click');
      if (window.dataset.maximized === 'true') {
        // Restore
        window.style.width = window.dataset.originalWidth || '550px';
        window.style.height = window.dataset.originalHeight || '500px';
        window.style.left = window.dataset.originalLeft || '150px';
        window.style.top = window.dataset.originalTop || '100px';
        window.dataset.maximized = 'false';
      } else {
        // Store original dimensions
        window.dataset.originalWidth = window.style.width;
        window.dataset.originalHeight = window.style.height;
        window.dataset.originalLeft = window.style.left;
        window.dataset.originalTop = window.style.top;
        
        // Maximize
        if (window.innerWidth <= 767) {
          window.style.width = '100vw';
          window.style.height = '100vh';
          window.style.left = '0';
          window.style.top = '0';
        } else {
          window.style.width = 'calc(100vw - 80px)';
          window.style.height = 'calc(100vh - 120px)';
          window.style.left = '40px';
          window.style.top = '40px';
        }
        window.dataset.maximized = 'true';
      }
    }

    function focusWindow(window) {
      // Unfocus all windows
      document.querySelectorAll('.window').forEach(w => {
        w.classList.remove('focused');
        w.classList.add('unfocused');
      });
      
      // Focus the target window
      window.classList.remove('unfocused');
      window.classList.add('focused');
      window.style.zIndex = ++windowZIndex;
      
      updateTaskbarButtons();
    }

    // Taskbar management - Windows 98 style
    function addTaskbarButton(windowId, window) {
      // Don't add if already exists
      if (document.getElementById(`taskbar-${windowId}`)) return;
      
      const taskbarButtons = document.getElementById('taskbarButtons');
      const button = document.createElement('div');
      button.className = 'taskbar-button';
      button.id = `taskbar-${windowId}`;
      button.onclick = () => toggleWindow(windowId);
      
      // Get icon and title from window
      const titleSpans = window.querySelectorAll('.window-title span');
      const icon = titleSpans[0] ? titleSpans[0].textContent : 'ü™ü';
      const title = titleSpans[1] ? titleSpans[1].textContent : 'Window';
      
      button.innerHTML = `<span style="font-size: 14px;">${icon}</span><span>${title.length > 15 ? title.substring(0, 15) + '...' : title}</span>`;
      taskbarButtons.appendChild(button);
      
      // Update button state
      updateTaskbarButtons();
    }

    function removeTaskbarButton(windowId) {
      const button = document.getElementById(`taskbar-${windowId}`);
      if (button) {
        button.remove();
        updateTaskbarButtons();
      }
    }

    function updateTaskbarButton(windowId, active) {
      const button = document.getElementById(`taskbar-${windowId}`);
      if (button) {
        if (active) {
          button.classList.add('active');
        } else {
          button.classList.remove('active');
        }
      }
    }

    function updateTaskbarButtons() {
      // Remove active class from all buttons
      document.querySelectorAll('.taskbar-button').forEach(button => {
        button.classList.remove('active');
      });
      
      // Add active class to focused window's button
      const focusedWindow = document.querySelector('.window.focused');
      if (focusedWindow) {
        const windowId = focusedWindow.id;
        updateTaskbarButton(windowId, true);
      }
    }

    function toggleWindow(windowId) {
      const window = document.getElementById(windowId);
      if (!window) return;

      if (window.style.display === 'none') {
        // Restore minimized window
        window.style.display = 'block';
        focusWindow(window);
      } else if (window.classList.contains('focused')) {
        // Minimize currently focused window
        minimizeWindow(windowId);
      } else {
        // Focus unfocused window
        focusWindow(window);
      }
    }

    // Make windows draggable (desktop only)
    function makeDraggable(element) {
      if (window.innerWidth <= 768) return; // Don't drag on mobile
      
      const header = element.querySelector('.window-header');
      if (!header || header.dataset.draggable === 'true') return; // Already made draggable
      
      header.dataset.draggable = 'true';
      let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

      header.onmousedown = dragMouseDown;

      function dragMouseDown(e) {
        // Don't drag if clicking on window controls
        if (e.target.closest('.window-controls')) return;
        
        e = e || window.event;
        e.preventDefault();
        pos3 = e.clientX;
        pos4 = e.clientY;
        
        // Bring window to front
        focusWindow(element);
        
        document.onmouseup = closeDragElement;
        document.onmousemove = elementDrag;
      }

      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        
        const newTop = element.offsetTop - pos2;
        const newLeft = element.offsetLeft - pos1;
        
        element.style.top = Math.max(0, Math.min(newTop, window.innerHeight - 100)) + "px";
        element.style.left = Math.max(0, Math.min(newLeft, window.innerWidth - 100)) + "px";
      }

      function closeDragElement() {
        document.onmouseup = null;
        document.onmousemove = null;
      }
    }

    // Start menu
    function toggleStartMenu() {
      playSound('click');
      const menu = document.getElementById('startMenu');
      startMenuOpen = !startMenuOpen;
      
      if (startMenuOpen) {
        menu.style.display = 'block';
      } else {
        menu.style.display = 'none';
      }
    }

    function closeStartMenu() {
      document.getElementById('startMenu').style.display = 'none';
      startMenuOpen = false;
    }

    // Close start menu when clicking outside
    document.addEventListener('click', function(e) {
      const startMenu = document.getElementById('startMenu');
      const startButton = document.querySelector('.start-button');
      if (!startMenu.contains(e.target) && !startButton.contains(e.target)) {
        closeStartMenu();
      }
    });

    // Theme changing
    function changeTheme(theme) {
      playSound('click');
      document.body.className = `theme-${theme}`;
      localStorage.setItem('selectedTheme', theme);
    }

    // Load saved theme
    const savedTheme = localStorage.getItem('selectedTheme');
    if (savedTheme) {
      changeTheme(savedTheme);
    }

    // Update time
    function updateClock() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('en-US', { 
        hour: 'numeric', 
        minute: '2-digit', 
        hour12: true 
      });
      document.getElementById('current-time').textContent = timeString;
    }
    
    updateClock();
    setInterval(updateClock, 1000);

    // Virus popup
    function showVirusPopup() {
      playSound('alert');
      document.getElementById('virusPopup').style.display = 'block';
    }

    function closeVirusPopup() {
      playSound('click');
      document.getElementById('virusPopup').style.display = 'none';
    }

    // Nostalgic notifications and popups
    function showMailNotification() {
      document.getElementById('mailNotification').style.display = 'block';
      setTimeout(() => {
        document.getElementById('mailNotification').style.display = 'none';
      }, 8000);
    }

    function hideMailNotification() {
      document.getElementById('mailNotification').style.display = 'none';
    }

    function showClippy() {
      document.getElementById('clippyAssistant').style.display = 'block';
    }

    function hideClippy() {
      document.getElementById('clippyAssistant').style.display = 'none';
      localStorage.setItem('clippyDismissed', 'true');
    }

    function showGrowthPopup() {
      document.getElementById('growthPopup').style.display = 'block';
    }

    function hideGrowthPopup() {
      document.getElementById('growthPopup').style.display = 'none';
      localStorage.setItem('growthPopupSeen', 'true');
    }

    function acceptGrowth() {
      playSound('success');
      alert('üî• Excellent choice! Your business is about to experience some SERIOUS growth and expansion! üìàüí™\n\nGet ready for rock-hard profits and massive success! üçÜüí¶');
      hideGrowthPopup();
      openWindow('download-window');
    }

    function triggerGrowthPopup() {
      setTimeout(() => {
        showGrowthPopup();
      }, 2000);
    }

    function showAbout() {
      playSound('click');
      alert('ResellAI OS v3.0\n\nThe ultimate AI-powered eBay reselling platform.\n\nTurn photos into profit with artificial intelligence!\n\n¬© 2024 ResellAI');
      closeStartMenu();
    }

    // Show nostalgic elements with delays
    setTimeout(showMailNotification, 4500);
    
    if (!localStorage.getItem('clippyDismissed')) {
      setTimeout(showClippy, 8000);
    }
    
    if (!localStorage.getItem('growthPopupSeen')) {
      setTimeout(showGrowthPopup, 18000);
    }

    // Auto-open main window after loading
    setTimeout(() => {
      openWindow('main-window');
    }, 5000);

    // Auto-trigger virus popup after some time
    setTimeout(() => {
      if (Math.random() > 0.5) {
        showVirusPopup();
      }
    }, 25000);

    // Initialize window click handlers and dragging
    document.addEventListener('DOMContentLoaded', function() {
      // Set up window focus handlers
      document.querySelectorAll('.window').forEach(window => {
        window.addEventListener('mousedown', function(e) {
          // Don't focus if clicking window controls
          if (e.target.closest('.window-controls')) return;
          focusWindow(this);
        });
      });
      
      // Make all windows draggable on desktop
      document.querySelectorAll('.window').forEach(makeDraggable);
      
      console.log('üöÄ ResellAI OS v3.0 initialized - drag windows around and use taskbar buttons!');
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        // Close all popups and windows
        closeVirusPopup();
        hideGrowthPopup();
        closeStartMenu();
      }
    });

    // Konami code easter egg
    const konamiCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
    let konamiIndex = 0;

    document.addEventListener('keydown', function(e) {
      if (e.keyCode === konamiCode[konamiIndex]) {
        konamiIndex++;
        if (konamiIndex === konamiCode.length) {
          playSound('success');
          alert('üéâ KONAMI CODE ACTIVATED! üéâ\n\nSecret ResellAI power unlocked!\nYou\'re clearly a pro gamer AND a pro reseller!');
          konamiIndex = 0;
          
          // Fun visual effect
          document.body.style.background = 'linear-gradient(45deg, #ff0000, #00ff00, #0000ff, #ff00ff)';
          document.body.style.backgroundSize = '400% 400%';
          document.body.style.animation = 'rainbow 2s ease infinite';
          
          setTimeout(() => {
            document.body.style.background = '';
            document.body.style.animation = '';
            // Restore theme
            const savedTheme = localStorage.getItem('selectedTheme');
            if (savedTheme) {
              changeTheme(savedTheme);
            }
          }, 5000);
        }
      } else {
        konamiIndex = 0;
      }
    });

    // Add rainbow animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes rainbow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
    `;
    document.head.appendChild(style);

    // Touch support for mobile
    if ('ontouchstart' in window) {
      // Add touch feedback
      document.querySelectorAll('.desktop-icon, .button, .window-button').forEach(element => {
        element.addEventListener('touchstart', function() {
          this.style.transform = 'scale(0.95)';
        });
        
        element.addEventListener('touchend', function() {
          this.style.transform = '';
        });
      });
    }

    // Mobile touch improvements
    document.addEventListener('touchstart', function() {}, {passive: true});
    
    // Prevent zoom on double tap for mobile
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
  </script>
</body>
</html>